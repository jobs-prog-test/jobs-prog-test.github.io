{"version":3,"file":"main-fe122147.js","sources":["../../node_modules/react/cjs/react-jsx-runtime.production.min.js","../../node_modules/react/jsx-runtime.js","../../node_modules/react-dom/client.js","../../src/data/defaultData.ts","../../src/utils/pdfFieldMapper.ts","../../src/utils/filenameGenerator.ts","../../node_modules/idb/build/wrap-idb-value.js","../../node_modules/idb/build/index.js","../../src/utils/pdfStorage.ts","../../src/utils/fillCTRPDF.ts","../../src/utils/fillExcelTemplate.ts","../../src/utils/CTRDataService.ts","../../src/components/Notification.tsx","../../src/utils/excelMapping.ts","../../src/utils/timeCalculations.ts","../../src/components/DateCalendar.tsx","../../src/components/StoredPDFs.tsx","../../src/components/MainTable.tsx","../../src/App.tsx","../../src/main.tsx"],"sourcesContent":["/**\n * @license React\n * react-jsx-runtime.production.min.js\n *\n * Copyright (c) Facebook, Inc. and its affiliates.\n *\n * This source code is licensed under the MIT license found in the\n * LICENSE file in the root directory of this source tree.\n */\n'use strict';var f=require(\"react\"),k=Symbol.for(\"react.element\"),l=Symbol.for(\"react.fragment\"),m=Object.prototype.hasOwnProperty,n=f.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,p={key:!0,ref:!0,__self:!0,__source:!0};\nfunction q(c,a,g){var b,d={},e=null,h=null;void 0!==g&&(e=\"\"+g);void 0!==a.key&&(e=\"\"+a.key);void 0!==a.ref&&(h=a.ref);for(b in a)m.call(a,b)&&!p.hasOwnProperty(b)&&(d[b]=a[b]);if(c&&c.defaultProps)for(b in a=c.defaultProps,a)void 0===d[b]&&(d[b]=a[b]);return{$$typeof:k,type:c,key:e,ref:h,props:d,_owner:n.current}}exports.Fragment=l;exports.jsx=q;exports.jsxs=q;\n","'use strict';\n\nif (process.env.NODE_ENV === 'production') {\n  module.exports = require('./cjs/react-jsx-runtime.production.min.js');\n} else {\n  module.exports = require('./cjs/react-jsx-runtime.development.js');\n}\n","'use strict';\n\nvar m = require('react-dom');\nif (process.env.NODE_ENV === 'production') {\n  exports.createRoot = m.createRoot;\n  exports.hydrateRoot = m.hydrateRoot;\n} else {\n  var i = m.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED;\n  exports.createRoot = function(c, o) {\n    i.usingClientEntryPoint = true;\n    try {\n      return m.createRoot(c, o);\n    } finally {\n      i.usingClientEntryPoint = false;\n    }\n  };\n  exports.hydrateRoot = function(c, h, o) {\n    i.usingClientEntryPoint = true;\n    try {\n      return m.hydrateRoot(c, h, o);\n    } finally {\n      i.usingClientEntryPoint = false;\n    }\n  };\n}\n","export const defaultData = [\r\n  {\r\n    name: 'John Smith',\r\n    classification: 'FFT1',\r\n    days: [\r\n      { date: '2024-06-01', on: '0830', off: '1730' },\r\n      { date: '2024-06-02', on: '0830', off: '1730' }\r\n    ]\r\n  },\r\n  {\r\n    name: 'Jane Doe',\r\n    classification: 'FFT2',\r\n    days: [\r\n      { date: '2024-06-01', on: '0830', off: '1730' },\r\n      { date: '2024-06-02', on: '0830', off: '1730' }\r\n    ]\r\n  }\r\n]; ","// Maps table data to PDF field names as extracted from pdf_fields.csv\r\nexport function mapToPDFFields(data: any[], crewInfo?: any, signature?: { name: string; signature: string }) {\r\n  const fields: Record<string, string> = {};\r\n  \r\n  // Crew info fields\r\n  if (crewInfo) {\r\n    fields['1 CREW NAME'] = crewInfo.crewName || '';\r\n    fields['2 CREW NUMER'] = crewInfo.crewNumber || '';\r\n    fields['4FIRE NAME'] = crewInfo.fireName || '';\r\n    fields['5 FIRE NUMBER'] = crewInfo.fireNumber || '';\r\n  }\r\n\r\n  // Populate DATE and DATE_2 fields from the first row's days if available\r\n  if (data[0]?.days[0]) {\r\n    fields['DATE'] = data[0].days[0].date;\r\n  }\r\n  if (data[0]?.days[1]) {\r\n    fields['DATE_2'] = data[0].days[1].date;\r\n  }\r\n\r\n  // Only map rows that have actual data\r\n  data.forEach((row, idx) => {\r\n    // Skip rows that don't have a name or classification\r\n    if (!row?.name && !row?.classification) return;\r\n\r\n    const rowNum = idx + 1;\r\n    \r\n    // Use the exact field names from your CSV\r\n    fields[`NAME OF EMPLOYEERow${rowNum}`] = row.name || '';\r\n    fields[`ClASS IF CATIONRow${rowNum}`] = row.classification || '';\r\n\r\n    // Day 1\r\n    if (row.days?.[0]) {\r\n      fields[`ONRow${rowNum}`] = row.days[0].on || '';\r\n      fields[`OFFRow${rowNum}`] = row.days[0].off || '';\r\n    }\r\n\r\n    // Day 2\r\n    if (row.days?.[1]) {\r\n      fields[`ONRow${rowNum}_2`] = row.days[1].on || '';\r\n      fields[`OFFRow${rowNum}_2`] = row.days[1].off || '';\r\n    }\r\n  });\r\n\r\n  return fields;\r\n} ","// Store function to generate formatted filenames\r\n// Initialize ExportInfo object\r\ninterface ExportInfo {\r\n  date: string;\r\n  crewNumber: string;\r\n  fireName: string;\r\n  fireNumber: string;\r\n  type: 'PDF' | 'Excel' | 'CSV';\r\n}\r\n\r\nexport function generateExportFilename(info: ExportInfo): string {\r\n  const { date, crewNumber, fireName, fireNumber, type } = info;\r\n  \r\n  // Format date to YYYY-MM-DD if it's not already\r\n  const formattedDate = date.includes('-') ? date : new Date(date).toISOString().split('T')[0];\r\n  \r\n  // Clean up the values to be filename-safe\r\n  const safeCrewNumber = crewNumber.replace(/[^a-zA-Z0-9]/g, '');\r\n  const safeFireName = fireName.replace(/[^a-zA-Z0-9]/g, '');\r\n  const safeFireNumber = fireNumber.replace(/[^a-zA-Z0-9]/g, '');\r\n  \r\n  // Generate the filename\r\n  const filename = `${formattedDate} ${safeCrewNumber} ${safeFireName} ${safeFireNumber} ${type} CTR`;\r\n  \r\n  // Add appropriate extension\r\n  switch (type) {\r\n    case 'PDF':\r\n      return `${filename}.pdf`;\r\n    case 'Excel':\r\n      return `${filename}.xlsx`;\r\n    case 'CSV':\r\n      return `${filename}.csv`;\r\n    default:\r\n      return filename;\r\n  }\r\n} ","const instanceOfAny = (object, constructors) => constructors.some((c) => object instanceof c);\n\nlet idbProxyableTypes;\nlet cursorAdvanceMethods;\n// This is a function to prevent it throwing up in node environments.\nfunction getIdbProxyableTypes() {\n    return (idbProxyableTypes ||\n        (idbProxyableTypes = [\n            IDBDatabase,\n            IDBObjectStore,\n            IDBIndex,\n            IDBCursor,\n            IDBTransaction,\n        ]));\n}\n// This is a function to prevent it throwing up in node environments.\nfunction getCursorAdvanceMethods() {\n    return (cursorAdvanceMethods ||\n        (cursorAdvanceMethods = [\n            IDBCursor.prototype.advance,\n            IDBCursor.prototype.continue,\n            IDBCursor.prototype.continuePrimaryKey,\n        ]));\n}\nconst cursorRequestMap = new WeakMap();\nconst transactionDoneMap = new WeakMap();\nconst transactionStoreNamesMap = new WeakMap();\nconst transformCache = new WeakMap();\nconst reverseTransformCache = new WeakMap();\nfunction promisifyRequest(request) {\n    const promise = new Promise((resolve, reject) => {\n        const unlisten = () => {\n            request.removeEventListener('success', success);\n            request.removeEventListener('error', error);\n        };\n        const success = () => {\n            resolve(wrap(request.result));\n            unlisten();\n        };\n        const error = () => {\n            reject(request.error);\n            unlisten();\n        };\n        request.addEventListener('success', success);\n        request.addEventListener('error', error);\n    });\n    promise\n        .then((value) => {\n        // Since cursoring reuses the IDBRequest (*sigh*), we cache it for later retrieval\n        // (see wrapFunction).\n        if (value instanceof IDBCursor) {\n            cursorRequestMap.set(value, request);\n        }\n        // Catching to avoid \"Uncaught Promise exceptions\"\n    })\n        .catch(() => { });\n    // This mapping exists in reverseTransformCache but doesn't doesn't exist in transformCache. This\n    // is because we create many promises from a single IDBRequest.\n    reverseTransformCache.set(promise, request);\n    return promise;\n}\nfunction cacheDonePromiseForTransaction(tx) {\n    // Early bail if we've already created a done promise for this transaction.\n    if (transactionDoneMap.has(tx))\n        return;\n    const done = new Promise((resolve, reject) => {\n        const unlisten = () => {\n            tx.removeEventListener('complete', complete);\n            tx.removeEventListener('error', error);\n            tx.removeEventListener('abort', error);\n        };\n        const complete = () => {\n            resolve();\n            unlisten();\n        };\n        const error = () => {\n            reject(tx.error || new DOMException('AbortError', 'AbortError'));\n            unlisten();\n        };\n        tx.addEventListener('complete', complete);\n        tx.addEventListener('error', error);\n        tx.addEventListener('abort', error);\n    });\n    // Cache it for later retrieval.\n    transactionDoneMap.set(tx, done);\n}\nlet idbProxyTraps = {\n    get(target, prop, receiver) {\n        if (target instanceof IDBTransaction) {\n            // Special handling for transaction.done.\n            if (prop === 'done')\n                return transactionDoneMap.get(target);\n            // Polyfill for objectStoreNames because of Edge.\n            if (prop === 'objectStoreNames') {\n                return target.objectStoreNames || transactionStoreNamesMap.get(target);\n            }\n            // Make tx.store return the only store in the transaction, or undefined if there are many.\n            if (prop === 'store') {\n                return receiver.objectStoreNames[1]\n                    ? undefined\n                    : receiver.objectStore(receiver.objectStoreNames[0]);\n            }\n        }\n        // Else transform whatever we get back.\n        return wrap(target[prop]);\n    },\n    set(target, prop, value) {\n        target[prop] = value;\n        return true;\n    },\n    has(target, prop) {\n        if (target instanceof IDBTransaction &&\n            (prop === 'done' || prop === 'store')) {\n            return true;\n        }\n        return prop in target;\n    },\n};\nfunction replaceTraps(callback) {\n    idbProxyTraps = callback(idbProxyTraps);\n}\nfunction wrapFunction(func) {\n    // Due to expected object equality (which is enforced by the caching in `wrap`), we\n    // only create one new func per func.\n    // Edge doesn't support objectStoreNames (booo), so we polyfill it here.\n    if (func === IDBDatabase.prototype.transaction &&\n        !('objectStoreNames' in IDBTransaction.prototype)) {\n        return function (storeNames, ...args) {\n            const tx = func.call(unwrap(this), storeNames, ...args);\n            transactionStoreNamesMap.set(tx, storeNames.sort ? storeNames.sort() : [storeNames]);\n            return wrap(tx);\n        };\n    }\n    // Cursor methods are special, as the behaviour is a little more different to standard IDB. In\n    // IDB, you advance the cursor and wait for a new 'success' on the IDBRequest that gave you the\n    // cursor. It's kinda like a promise that can resolve with many values. That doesn't make sense\n    // with real promises, so each advance methods returns a new promise for the cursor object, or\n    // undefined if the end of the cursor has been reached.\n    if (getCursorAdvanceMethods().includes(func)) {\n        return function (...args) {\n            // Calling the original function with the proxy as 'this' causes ILLEGAL INVOCATION, so we use\n            // the original object.\n            func.apply(unwrap(this), args);\n            return wrap(cursorRequestMap.get(this));\n        };\n    }\n    return function (...args) {\n        // Calling the original function with the proxy as 'this' causes ILLEGAL INVOCATION, so we use\n        // the original object.\n        return wrap(func.apply(unwrap(this), args));\n    };\n}\nfunction transformCachableValue(value) {\n    if (typeof value === 'function')\n        return wrapFunction(value);\n    // This doesn't return, it just creates a 'done' promise for the transaction,\n    // which is later returned for transaction.done (see idbObjectHandler).\n    if (value instanceof IDBTransaction)\n        cacheDonePromiseForTransaction(value);\n    if (instanceOfAny(value, getIdbProxyableTypes()))\n        return new Proxy(value, idbProxyTraps);\n    // Return the same value back if we're not going to transform it.\n    return value;\n}\nfunction wrap(value) {\n    // We sometimes generate multiple promises from a single IDBRequest (eg when cursoring), because\n    // IDB is weird and a single IDBRequest can yield many responses, so these can't be cached.\n    if (value instanceof IDBRequest)\n        return promisifyRequest(value);\n    // If we've already transformed this value before, reuse the transformed value.\n    // This is faster, but it also provides object equality.\n    if (transformCache.has(value))\n        return transformCache.get(value);\n    const newValue = transformCachableValue(value);\n    // Not all types are transformed.\n    // These may be primitive types, so they can't be WeakMap keys.\n    if (newValue !== value) {\n        transformCache.set(value, newValue);\n        reverseTransformCache.set(newValue, value);\n    }\n    return newValue;\n}\nconst unwrap = (value) => reverseTransformCache.get(value);\n\nexport { reverseTransformCache as a, instanceOfAny as i, replaceTraps as r, unwrap as u, wrap as w };\n","import { w as wrap, r as replaceTraps } from './wrap-idb-value.js';\nexport { u as unwrap, w as wrap } from './wrap-idb-value.js';\n\n/**\n * Open a database.\n *\n * @param name Name of the database.\n * @param version Schema version.\n * @param callbacks Additional callbacks.\n */\nfunction openDB(name, version, { blocked, upgrade, blocking, terminated } = {}) {\n    const request = indexedDB.open(name, version);\n    const openPromise = wrap(request);\n    if (upgrade) {\n        request.addEventListener('upgradeneeded', (event) => {\n            upgrade(wrap(request.result), event.oldVersion, event.newVersion, wrap(request.transaction), event);\n        });\n    }\n    if (blocked) {\n        request.addEventListener('blocked', (event) => blocked(\n        // Casting due to https://github.com/microsoft/TypeScript-DOM-lib-generator/pull/1405\n        event.oldVersion, event.newVersion, event));\n    }\n    openPromise\n        .then((db) => {\n        if (terminated)\n            db.addEventListener('close', () => terminated());\n        if (blocking) {\n            db.addEventListener('versionchange', (event) => blocking(event.oldVersion, event.newVersion, event));\n        }\n    })\n        .catch(() => { });\n    return openPromise;\n}\n/**\n * Delete a database.\n *\n * @param name Name of the database.\n */\nfunction deleteDB(name, { blocked } = {}) {\n    const request = indexedDB.deleteDatabase(name);\n    if (blocked) {\n        request.addEventListener('blocked', (event) => blocked(\n        // Casting due to https://github.com/microsoft/TypeScript-DOM-lib-generator/pull/1405\n        event.oldVersion, event));\n    }\n    return wrap(request).then(() => undefined);\n}\n\nconst readMethods = ['get', 'getKey', 'getAll', 'getAllKeys', 'count'];\nconst writeMethods = ['put', 'add', 'delete', 'clear'];\nconst cachedMethods = new Map();\nfunction getMethod(target, prop) {\n    if (!(target instanceof IDBDatabase &&\n        !(prop in target) &&\n        typeof prop === 'string')) {\n        return;\n    }\n    if (cachedMethods.get(prop))\n        return cachedMethods.get(prop);\n    const targetFuncName = prop.replace(/FromIndex$/, '');\n    const useIndex = prop !== targetFuncName;\n    const isWrite = writeMethods.includes(targetFuncName);\n    if (\n    // Bail if the target doesn't exist on the target. Eg, getAll isn't in Edge.\n    !(targetFuncName in (useIndex ? IDBIndex : IDBObjectStore).prototype) ||\n        !(isWrite || readMethods.includes(targetFuncName))) {\n        return;\n    }\n    const method = async function (storeName, ...args) {\n        // isWrite ? 'readwrite' : undefined gzipps better, but fails in Edge :(\n        const tx = this.transaction(storeName, isWrite ? 'readwrite' : 'readonly');\n        let target = tx.store;\n        if (useIndex)\n            target = target.index(args.shift());\n        // Must reject if op rejects.\n        // If it's a write operation, must reject if tx.done rejects.\n        // Must reject with op rejection first.\n        // Must resolve with op value.\n        // Must handle both promises (no unhandled rejections)\n        return (await Promise.all([\n            target[targetFuncName](...args),\n            isWrite && tx.done,\n        ]))[0];\n    };\n    cachedMethods.set(prop, method);\n    return method;\n}\nreplaceTraps((oldTraps) => ({\n    ...oldTraps,\n    get: (target, prop, receiver) => getMethod(target, prop) || oldTraps.get(target, prop, receiver),\n    has: (target, prop) => !!getMethod(target, prop) || oldTraps.has(target, prop),\n}));\n\nexport { deleteDB, openDB };\n","import { openDB } from 'idb';\r\n\r\nconst DB_NAME = 'ctr-pdf-storage';\r\nconst STORE_NAME = 'pdfs';\r\nconst DB_VERSION = 1;\r\n\r\n// Initialize the database\r\nasync function initDB() {\r\n  console.log('Initializing IndexedDB...');\r\n  return openDB(DB_NAME, DB_VERSION, {\r\n    upgrade(db) {\r\n      console.log('Upgrading database...');\r\n      if (!db.objectStoreNames.contains(STORE_NAME)) {\r\n        console.log('Creating object store...');\r\n        db.createObjectStore(STORE_NAME, { keyPath: 'id' });\r\n      }\r\n    },\r\n  });\r\n}\r\n\r\n// Store a PDF in IndexedDB\r\nexport async function storePDF(pdfBlob: Blob, metadata: {\r\n  filename: string;\r\n  date: string;\r\n  crewNumber: string;\r\n  fireName: string;\r\n  fireNumber: string;\r\n}) {\r\n  console.log('Storing PDF in IndexedDB...', metadata);\r\n  const db = await initDB();\r\n  const id = `${metadata.date}_${metadata.crewNumber}_${metadata.fireName}_${metadata.fireNumber}`;\r\n  \r\n  try {\r\n    await db.put(STORE_NAME, {\r\n      id,\r\n      pdf: pdfBlob,\r\n      metadata,\r\n      timestamp: new Date().toISOString()\r\n    });\r\n    console.log('PDF stored successfully with ID:', id);\r\n    return id;\r\n  } catch (error) {\r\n    console.error('Error storing PDF:', error);\r\n    throw error;\r\n  }\r\n}\r\n\r\n// Retrieve a PDF from IndexedDB\r\nexport async function getPDF(id: string) {\r\n  console.log('Retrieving PDF from IndexedDB:', id);\r\n  const db = await initDB();\r\n  const pdf = await db.get(STORE_NAME, id);\r\n  console.log('Retrieved PDF:', pdf ? 'Found' : 'Not found');\r\n  return pdf;\r\n}\r\n\r\n// List all stored PDFs\r\nexport async function listPDFs() {\r\n  console.log('Listing all PDFs from IndexedDB...');\r\n  try {\r\n    const db = await initDB();\r\n    console.log('Database initialized successfully');\r\n    \r\n    const pdfs = await db.getAll(STORE_NAME);\r\n    console.log('Found PDFs:', pdfs.length);\r\n    console.log('PDFs data:', pdfs);\r\n    \r\n    return pdfs;\r\n  } catch (error) {\r\n    console.error('Error in listPDFs:', error);\r\n    if (error instanceof Error) {\r\n      console.error('Error details:', error.message);\r\n      console.error('Error stack:', error.stack);\r\n    }\r\n    throw error;\r\n  }\r\n}\r\n\r\n// Delete a PDF from IndexedDB\r\nexport async function deletePDF(id: string) {\r\n  console.log('Deleting PDF from IndexedDB:', id);\r\n  const db = await initDB();\r\n  await db.delete(STORE_NAME, id);\r\n  console.log('PDF deleted successfully');\r\n} ","import { PDFDocument } from 'pdf-lib';\r\nimport { mapToPDFFields } from './pdfFieldMapper';\r\nimport { generateExportFilename } from './filenameGenerator';\r\nimport { storePDF } from './pdfStorage';\r\n\r\n// Fills the CTR PDF and triggers a download\r\nexport async function fillCTRPDF(data: any[], crewInfo: any, pdfUrl = '/CTR_Fillable_Edited.pdf') {\r\n  try {\r\n    // Add cache-busting query parameter and force network fetch\r\n    const urlWithCacheBust = `${pdfUrl}?t=${Date.now()}`;\r\n    const response = await fetch(urlWithCacheBust, {\r\n      cache: 'no-store', // Force network fetch\r\n      headers: {\r\n        'Cache-Control': 'no-cache, no-store, must-revalidate',\r\n        'Pragma': 'no-cache'\r\n      }\r\n    });\r\n    \r\n    if (!response.ok) {\r\n      throw new Error(`Failed to fetch PDF: ${response.statusText}`);\r\n    }\r\n\r\n    const pdfBytes = await response.arrayBuffer();\r\n    const pdfDoc = await PDFDocument.load(pdfBytes);\r\n\r\n    const form = pdfDoc.getForm();\r\n    const fields = mapToPDFFields(data, crewInfo);\r\n\r\n    // Debug: Log available form fields\r\n    console.log('Available PDF form fields:', form.getFields().map(f => f.getName()));\r\n\r\n    // Fill fields\r\n    Object.entries(fields).forEach(([field, value]) => {\r\n      try {\r\n        console.log(`Attempting to fill field: ${field} with value: ${value}`);\r\n        form.getTextField(field).setText(value);\r\n      } catch (e) {\r\n        // Field might not exist, skip or log\r\n        console.warn(`Field ${field} not found in PDF:`, e);\r\n      }\r\n    });\r\n\r\n    // Save and trigger download\r\n    const filledPdfBytes = await pdfDoc.save();\r\n    const blob = new Blob([filledPdfBytes], { type: 'application/pdf' });\r\n    \r\n    // Generate filename\r\n    const filename = generateExportFilename({\r\n      date: data[0]?.days[0]?.date || new Date().toISOString().split('T')[0],\r\n      crewNumber: crewInfo.crewNumber || '',\r\n      fireName: crewInfo.fireName || '',\r\n      fireNumber: crewInfo.fireNumber || '',\r\n      type: 'PDF'\r\n    });\r\n\r\n    // Store in IndexedDB\r\n    await storePDF(blob, {\r\n      filename,\r\n      date: data[0]?.days[0]?.date || new Date().toISOString().split('T')[0],\r\n      crewNumber: crewInfo.crewNumber || '',\r\n      fireName: crewInfo.fireName || '',\r\n      fireNumber: crewInfo.fireNumber || ''\r\n    });\r\n\r\n    // Trigger download\r\n    const url = URL.createObjectURL(blob);\r\n    const a = document.createElement('a');\r\n    a.href = url;\r\n    a.download = filename;\r\n    a.click();\r\n    URL.revokeObjectURL(url);\r\n  } catch (error) {\r\n    console.error('Error filling PDF:', error);\r\n    if (error instanceof Error) {\r\n      throw error;\r\n    }\r\n    throw new Error('Failed to generate PDF. Please check your internet connection and try again.');\r\n  }\r\n} ","import * as XLSX from 'xlsx';\r\n\r\ninterface CrewMember {\r\n  remarkNumber?: string;\r\n  name: string;\r\n  classification: string;\r\n  days: {\r\n    date: string;\r\n    on: string;\r\n    off: string;\r\n  }[];\r\n}\r\n\r\ninterface CrewInfo {\r\n  crewName: string;\r\n  crewNumber: string;\r\n  fireName: string;\r\n  fireNumber: string;\r\n}\r\n\r\ninterface TemplateMapping {\r\n  // Header Information\r\n  crewName?: string;      // Cell for crew name\r\n  crewNumber?: string;    // Cell for crew number\r\n  fireName?: string;      // Cell for fire name\r\n  fireNumber?: string;    // Cell for fire number\r\n  date1?: string;         // Cell for first date\r\n  date2?: string;         // Cell for second date\r\n\r\n  // Data Start Position\r\n  nameStartRow?: number;  // Starting row for crew member data\r\n  nameCol?: string;       // Column for names\r\n  classCol?: string;      // Column for classifications\r\n  on1Col?: string;        // Column for first day ON times\r\n  off1Col?: string;       // Column for first day OFF times\r\n  on2Col?: string;        // Column for second day ON times\r\n  off2Col?: string;       // Column for second day OFF times\r\n\r\n  // Total Hours\r\n  totalHoursRow?: number; // Row for total hours\r\n  totalHoursCol?: string; // Column for total hours\r\n}\r\n\r\n// CTR Template Mapping\r\nconst CTR_TEMPLATE_MAPPING: TemplateMapping = {\r\n  // Header Information\r\n  crewName: 'A1',         // Crew Name\r\n  crewNumber: 'F1',       // Crew Number\r\n  fireName: 'C2',         // Fire Name\r\n  fireNumber: 'F2',       // Fire Number\r\n  date1: 'F4',           // First Date\r\n  date2: 'H4',           // Second Date\r\n\r\n  // Data Start Position\r\n  nameStartRow: 6,        // Start from row 6\r\n  nameCol: 'B',          // Names in column B (B6-B25)\r\n  classCol: 'D',         // Classifications in column D\r\n  on1Col: 'E',           // First day ON times in column E (E6-E25)\r\n  off1Col: 'F',          // First day OFF times in column F (F6-F25)\r\n  on2Col: 'G',           // Second day ON times in column G\r\n  off2Col: 'H',          // Second day OFF times in column H\r\n\r\n  // Total Hours\r\n  totalHoursRow: 30,     // Total hours in row 30\r\n  totalHoursCol: 'C'     // Total hours in column C\r\n};\r\n\r\nexport async function fillExcelTemplate(\r\n  data: any[],\r\n  crewInfo: any,\r\n  days: string[],\r\n  templateUrl = '/CTR_Template.xlsx',\r\n  mapping: TemplateMapping = CTR_TEMPLATE_MAPPING\r\n): Promise<XLSX.WorkBook> {\r\n  try {\r\n    // Validate input data\r\n    if (!Array.isArray(data)) {\r\n      throw new Error('Data must be an array');\r\n    }\r\n\r\n    // Fetch the template\r\n    const response = await fetch(templateUrl);\r\n    if (!response.ok) {\r\n      throw new Error(`Failed to fetch template: ${response.statusText}`);\r\n    }\r\n    \r\n    const templateData = await response.arrayBuffer();\r\n    const workbook = XLSX.read(templateData, { type: 'array' });\r\n    const worksheet = workbook.Sheets[workbook.SheetNames[0]];\r\n\r\n    // Fill header info\r\n    if (mapping.crewName) {\r\n      worksheet[mapping.crewName] = { t: 's', v: crewInfo?.crewName || '' };\r\n    }\r\n    if (mapping.crewNumber) {\r\n      worksheet[mapping.crewNumber] = { t: 's', v: crewInfo?.crewNumber || '' };\r\n    }\r\n    if (mapping.fireName) {\r\n      worksheet[mapping.fireName] = { t: 's', v: crewInfo?.fireName || '' };\r\n    }\r\n    if (mapping.fireNumber) {\r\n      worksheet[mapping.fireNumber] = { t: 's', v: crewInfo?.fireNumber || '' };\r\n    }\r\n\r\n    // Fill dates\r\n    if (mapping.date1) {\r\n      worksheet[mapping.date1] = { t: 's', v: days?.[0] || '' };\r\n    }\r\n    if (mapping.date2) {\r\n      worksheet[mapping.date2] = { t: 's', v: days?.[1] || '' };\r\n    }\r\n\r\n    // Fill crew member data\r\n    const startRow = mapping.nameStartRow || 6;\r\n    data.forEach((row, idx) => {\r\n      // Skip if row is undefined or has no data\r\n      if (!row || (!row.name && !row.classification)) return;\r\n      \r\n      const rowNum = startRow + idx;\r\n      if (rowNum > startRow + 19) return; // Don't exceed 20 rows\r\n\r\n      // Fill name and classification\r\n      if (mapping.nameCol) {\r\n        worksheet[`${mapping.nameCol}${rowNum}`] = { t: 's', v: row.name || '' };\r\n      }\r\n      if (mapping.classCol) {\r\n        worksheet[`${mapping.classCol}${rowNum}`] = { t: 's', v: row.classification || '' };\r\n      }\r\n\r\n      // Fill times for day 1\r\n      if (row.days?.[0]) {\r\n        if (mapping.on1Col) {\r\n          worksheet[`${mapping.on1Col}${rowNum}`] = { t: 's', v: row.days[0].on || '' };\r\n        }\r\n        if (mapping.off1Col) {\r\n          worksheet[`${mapping.off1Col}${rowNum}`] = { t: 's', v: row.days[0].off || '' };\r\n        }\r\n      }\r\n\r\n      // Fill times for day 2\r\n      if (row.days?.[1]) {\r\n        if (mapping.on2Col) {\r\n          worksheet[`${mapping.on2Col}${rowNum}`] = { t: 's', v: row.days[1].on || '' };\r\n        }\r\n        if (mapping.off2Col) {\r\n          worksheet[`${mapping.off2Col}${rowNum}`] = { t: 's', v: row.days[1].off || '' };\r\n        }\r\n      }\r\n    });\r\n\r\n    // Calculate and fill total hours\r\n    const totalHours = calculateTotalHours(data);\r\n    if (mapping.totalHoursRow && mapping.totalHoursCol) {\r\n      worksheet[`${mapping.totalHoursCol}${mapping.totalHoursRow}`] = { t: 'n', v: totalHours };\r\n    }\r\n\r\n    return workbook;\r\n  } catch (error) {\r\n    console.error('Error filling Excel template:', error);\r\n    throw error;\r\n  }\r\n}\r\n\r\nfunction findHeaderCells(worksheet: XLSX.WorkSheet): TemplateMapping {\r\n  const mapping: TemplateMapping = {};\r\n  const range = XLSX.utils.decode_range(worksheet['!ref'] || 'A1');\r\n\r\n  // Search for header patterns\r\n  for (let R = range.s.r; R <= range.e.r; R++) {\r\n    for (let C = range.s.c; C <= range.e.c; C++) {\r\n      const cell = worksheet[XLSX.utils.encode_cell({ r: R, c: C })];\r\n      if (!cell || !cell.v) continue;\r\n\r\n      const value = String(cell.v).toLowerCase();\r\n      const cellRef = XLSX.utils.encode_cell({ r: R, c: C });\r\n\r\n      // Look for header patterns\r\n      if (value.includes('crew') && value.includes('name')) {\r\n        mapping.crewName = cellRef;\r\n      } else if (value.includes('crew') && value.includes('number')) {\r\n        mapping.crewNumber = cellRef;\r\n      } else if (value.includes('fire') && value.includes('name')) {\r\n        mapping.fireName = cellRef;\r\n      } else if (value.includes('fire') && value.includes('number')) {\r\n        mapping.fireNumber = cellRef;\r\n      } else if (value.includes('date') && !mapping.date1) {\r\n        mapping.date1 = cellRef;\r\n      } else if (value.includes('date') && mapping.date1) {\r\n        mapping.date2 = cellRef;\r\n      } else if (value.includes('name') && !mapping.nameCol) {\r\n        mapping.nameCol = XLSX.utils.encode_col(C);\r\n        mapping.nameStartRow = R + 1;\r\n      } else if (value.includes('class') && !mapping.classCol) {\r\n        mapping.classCol = XLSX.utils.encode_col(C);\r\n      } else if (value.includes('on') && !mapping.on1Col) {\r\n        mapping.on1Col = XLSX.utils.encode_col(C);\r\n      } else if (value.includes('off') && !mapping.off1Col) {\r\n        mapping.off1Col = XLSX.utils.encode_col(C);\r\n      } else if (value.includes('total') && value.includes('hours')) {\r\n        mapping.totalHoursRow = R;\r\n        mapping.totalHoursCol = XLSX.utils.encode_col(C + 1); // Assuming total is in next column\r\n      }\r\n    }\r\n  }\r\n\r\n  return mapping;\r\n}\r\n\r\nfunction calculateTotalHours(data: CrewMember[]): number {\r\n  if (!Array.isArray(data)) return 0;\r\n  \r\n  let total = 0;\r\n  for (const row of data) {\r\n    if (!row || !row.days || !Array.isArray(row.days)) continue;\r\n    \r\n    for (const day of row.days) {\r\n      if (!day) continue;\r\n      const on = parseMilitaryTime(day.on);\r\n      const off = parseMilitaryTime(day.off);\r\n      if (on !== null && off !== null && off >= on) {\r\n        total += off - on;\r\n      }\r\n    }\r\n  }\r\n  return Number(total.toFixed(2));\r\n}\r\n\r\nfunction parseMilitaryTime(time: string): number | null {\r\n  if (!/^\\d{4}$/.test(time)) return null;\r\n  const h = parseInt(time.slice(0, 2), 10);\r\n  const m = parseInt(time.slice(2, 4), 10);\r\n  if (h > 23 || m > 59) return null;\r\n  return h + m / 60;\r\n} ","import { openDB, DBSchema, IDBPDatabase } from 'idb';\r\n\r\ninterface CTRData extends DBSchema {\r\n  ctr_records: {\r\n    key: string; // date range as key (YYYY-MM-DD to YYYY-MM-DD)\r\n    value: {\r\n      dateRange: string;\r\n      data: any[];\r\n      crewInfo: {\r\n        crewName: string;\r\n        crewNumber: string;\r\n        fireName: string;\r\n        fireNumber: string;\r\n      };\r\n    };\r\n  };\r\n}\r\n\r\nclass CTRDataService {\r\n  private db: IDBPDatabase<CTRData> | null = null;\r\n  private readonly DB_NAME = 'ctr-database';\r\n  private readonly STORE_NAME = 'ctr_records';\r\n\r\n  async initDB() {\r\n    if (!this.db) {\r\n      this.db = await openDB<CTRData>(this.DB_NAME, 1, {\r\n        upgrade(db) {\r\n          if (!db.objectStoreNames.contains('ctr_records')) {\r\n            db.createObjectStore('ctr_records');\r\n          }\r\n        },\r\n      });\r\n    }\r\n    return this.db;\r\n  }\r\n\r\n  private formatDateRange(date1: string, date2: string): string {\r\n    return `${date1} to ${date2}`;\r\n  }\r\n\r\n  async saveRecord(date1: string, date2: string, data: any[], crewInfo: any) {\r\n    const db = await this.initDB();\r\n    const dateRange = this.formatDateRange(date1, date2);\r\n    console.log('Saving date range:', dateRange);\r\n    await db.put(this.STORE_NAME, {\r\n      dateRange,\r\n      data,\r\n      crewInfo\r\n    }, dateRange);\r\n  }\r\n\r\n  async getRecord(dateRange: string) {\r\n    const db = await this.initDB();\r\n    console.log('Getting record for date range:', dateRange);\r\n    return db.get(this.STORE_NAME, dateRange);\r\n  }\r\n\r\n  async getAllDateRanges(): Promise<string[]> {\r\n    const db = await this.initDB();\r\n    const ranges = await db.getAllKeys(this.STORE_NAME);\r\n    console.log('All date ranges:', ranges);\r\n    return ranges;\r\n  }\r\n\r\n  async deleteRecord(dateRange: string) {\r\n    const db = await this.initDB();\r\n    await db.delete(this.STORE_NAME, dateRange);\r\n  }\r\n}\r\n\r\nexport const ctrDataService = new CTRDataService(); ","import React from 'react';\r\nimport './Notification.css';\r\n\r\ninterface NotificationProps {\r\n  message: string;\r\n  type: 'success' | 'info' | 'warning' | 'error';\r\n  onClose: () => void;\r\n  duration?: number;\r\n}\r\n\r\nexport function Notification(props: NotificationProps) {\r\n  const { message, type, onClose, duration = 3000 } = props;\r\n\r\n  React.useEffect(() => {\r\n    const timer = setTimeout(() => {\r\n      onClose();\r\n    }, duration);\r\n\r\n    return () => clearTimeout(timer);\r\n  }, [duration, onClose]);\r\n\r\n  return (\r\n    <div className={`notification notification-${type}`}>\r\n      <div className=\"notification-content\">\r\n        {message}\r\n      </div>\r\n      <button className=\"notification-close\" onClick={onClose}>×</button>\r\n    </div>\r\n  );\r\n} ","import { CrewMember, CrewInfo } from '../types/CTRTypes';\r\nimport * as XLSX from 'xlsx';\r\n\r\n// Define the expected cell locations in the Excel template\r\nexport const EXCEL_CELL_MAPPING = {\r\n  crewInfo: {\r\n    crewName: 'B1',\r\n    crewNumber: 'H1',\r\n    fireName: 'C2',\r\n    fireNumber: 'H2'\r\n  },\r\n  dates: {\r\n    date1: 'F4',\r\n    date2: 'H4'\r\n  },\r\n  crewMembers: {\r\n    startRow: 6, // Excel row 6 is where crew member data starts\r\n    columns: {\r\n      name: 'B',\r\n      classification: 'D',\r\n      on1: 'E',\r\n      off1: 'F',\r\n      on2: 'G',\r\n      off2: 'H'\r\n    }\r\n  }\r\n};\r\n\r\nfunction getMergedCellValue(worksheet: XLSX.WorkSheet, cellAddress: string): any {\r\n  // Check if the cell has a value\r\n  if (worksheet[cellAddress] && worksheet[cellAddress].v !== undefined) {\r\n    return worksheet[cellAddress].v;\r\n  }\r\n  // Check for merges\r\n  const merges = worksheet['!merges'] || [];\r\n  const XLSXUtils = XLSX.utils.decode_cell;\r\n  const target = XLSXUtils(cellAddress);\r\n\r\n  for (const merge of merges) {\r\n    // Check if the cell is within this merge range\r\n    if (\r\n      target.r >= merge.s.r && target.r <= merge.e.r &&\r\n      target.c >= merge.s.c && target.c <= merge.e.c\r\n    ) {\r\n      // Get the top-left cell of the merge\r\n      const topLeft = XLSX.utils.encode_cell({ r: merge.s.r, c: merge.s.c });\r\n      return worksheet[topLeft]?.v ?? '';\r\n    }\r\n  }\r\n  return '';\r\n}\r\n\r\nexport function mapExcelToData(worksheet: XLSX.WorkSheet): { crewInfo: CrewInfo; crewMembers: CrewMember[] } {\r\n  // Extract crew info from specific cells\r\n  const crewInfo: CrewInfo = {\r\n    crewName: getMergedCellValue(worksheet, EXCEL_CELL_MAPPING.crewInfo.crewName) || '',\r\n    crewNumber: getMergedCellValue(worksheet, EXCEL_CELL_MAPPING.crewInfo.crewNumber) || '',\r\n    fireName: getMergedCellValue(worksheet, EXCEL_CELL_MAPPING.crewInfo.fireName) || '',\r\n    fireNumber: getMergedCellValue(worksheet, EXCEL_CELL_MAPPING.crewInfo.fireNumber) || ''\r\n  };\r\n\r\n  // Extract dates from specific cells\r\n  const date1 = getMergedCellValue(worksheet, EXCEL_CELL_MAPPING.dates.date1) || '';\r\n  const date2 = getMergedCellValue(worksheet, EXCEL_CELL_MAPPING.dates.date2) || '';\r\n\r\n  const crewMembers: CrewMember[] = [];\r\n  let row = EXCEL_CELL_MAPPING.crewMembers.startRow;\r\n  \r\n  // Read up to 20 crew members (rows 6-25)\r\n  while (row <= 25) {\r\n    // Get the name cell for this row\r\n    const nameCell = worksheet[`${EXCEL_CELL_MAPPING.crewMembers.columns.name}${row}`];\r\n    \r\n    // If no name is found in the expected cell, stop reading\r\n    if (!nameCell?.v) break;\r\n\r\n    // Create crew member object with data from specific cells\r\n    const crewMember: CrewMember = {\r\n      name: getMergedCellValue(worksheet, `${EXCEL_CELL_MAPPING.crewMembers.columns.name}${row}`),\r\n      classification: getMergedCellValue(worksheet, `${EXCEL_CELL_MAPPING.crewMembers.columns.classification}${row}`),\r\n      days: [\r\n        {\r\n          date: date1,\r\n          on: getMergedCellValue(worksheet, `${EXCEL_CELL_MAPPING.crewMembers.columns.on1}${row}`),\r\n          off: getMergedCellValue(worksheet, `${EXCEL_CELL_MAPPING.crewMembers.columns.off1}${row}`)\r\n        },\r\n        {\r\n          date: date2,\r\n          on: getMergedCellValue(worksheet, `${EXCEL_CELL_MAPPING.crewMembers.columns.on2}${row}`),\r\n          off: getMergedCellValue(worksheet, `${EXCEL_CELL_MAPPING.crewMembers.columns.off2}${row}`)\r\n        }\r\n      ]\r\n    };\r\n\r\n    crewMembers.push(crewMember);\r\n    row++;\r\n  }\r\n\r\n  return { crewInfo, crewMembers };\r\n}\r\n\r\nexport function mapDataToExcel(data: { crewInfo: CrewInfo; crewMembers: CrewMember[] }): XLSX.WorkSheet {\r\n  const worksheet: XLSX.WorkSheet = {};\r\n\r\n  // Set crew info in specific cells\r\n  worksheet[EXCEL_CELL_MAPPING.crewInfo.crewName] = { t: 's', v: data.crewInfo.crewName };\r\n  worksheet[EXCEL_CELL_MAPPING.crewInfo.crewNumber] = { t: 's', v: data.crewInfo.crewNumber };\r\n  worksheet[EXCEL_CELL_MAPPING.crewInfo.fireName] = { t: 's', v: data.crewInfo.fireName };\r\n  worksheet[EXCEL_CELL_MAPPING.crewInfo.fireNumber] = { t: 's', v: data.crewInfo.fireNumber };\r\n\r\n  // Set dates in specific cells\r\n  if (data.crewMembers[0]?.days[0]) {\r\n    worksheet[EXCEL_CELL_MAPPING.dates.date1] = { t: 's', v: data.crewMembers[0].days[0].date };\r\n  }\r\n  if (data.crewMembers[0]?.days[1]) {\r\n    worksheet[EXCEL_CELL_MAPPING.dates.date2] = { t: 's', v: data.crewMembers[0].days[1].date };\r\n  }\r\n\r\n  // Set crew member data in specific cells\r\n  data.crewMembers.forEach((member, index) => {\r\n    const row = EXCEL_CELL_MAPPING.crewMembers.startRow + index;\r\n    \r\n    // Set name and classification\r\n    worksheet[`${EXCEL_CELL_MAPPING.crewMembers.columns.name}${row}`] = { t: 's', v: member.name };\r\n    worksheet[`${EXCEL_CELL_MAPPING.crewMembers.columns.classification}${row}`] = { t: 's', v: member.classification };\r\n    \r\n    // Set first day's times\r\n    if (member.days[0]) {\r\n      worksheet[`${EXCEL_CELL_MAPPING.crewMembers.columns.on1}${row}`] = { t: 's', v: member.days[0].on };\r\n      worksheet[`${EXCEL_CELL_MAPPING.crewMembers.columns.off1}${row}`] = { t: 's', v: member.days[0].off };\r\n    }\r\n    \r\n    // Set second day's times\r\n    if (member.days[1]) {\r\n      worksheet[`${EXCEL_CELL_MAPPING.crewMembers.columns.on2}${row}`] = { t: 's', v: member.days[1].on };\r\n      worksheet[`${EXCEL_CELL_MAPPING.crewMembers.columns.off2}${row}`] = { t: 's', v: member.days[1].off };\r\n    }\r\n  });\r\n\r\n  return worksheet;\r\n} ","// File containing functions for calculate hours\r\n\r\n// CrewMember object with times\r\ninterface CrewMember {\r\n  name: string;\r\n  classification: string;\r\n  days: Array<{\r\n    on: string;\r\n    off: string;\r\n  }>;\r\n}\r\n\r\n// Declare function and export\r\nexport function calculateTotalHours(data: CrewMember[]): number {\r\n  // initialize to totalHours to zero\r\n  let totalHours = 0;\r\n\r\n  // iterate over each CrewMember in data array\r\n  data.forEach(member => {\r\n    // if days empty for member - skip\r\n    if (!member.days) return;\r\n    \r\n    // iterates over each day for crew member\r\n    member.days.forEach(day => {\r\n      // skip if on or off time is missing\r\n      if (!day.on || !day.off) return;\r\n      \r\n      // converts on and off time to minutes\r\n      const onTime = convertToMinutes(day.on);\r\n      const offTime = convertToMinutes(day.off);\r\n\r\n      // skips if conversion fails\r\n      if (onTime === null || offTime === null) return;\r\n\r\n      // convert total minutes to total hours\r\n      let hours = (offTime - onTime) / 60;\r\n      \r\n      // Handle overnight shifts\r\n      if (hours < 0) {\r\n        hours += 24;\r\n      }\r\n\r\n      // calculate running total\r\n      totalHours += hours;\r\n    });\r\n  });\r\n  // round total hours to two decimals\r\n  return Number(totalHours.toFixed(2));\r\n}\r\n\r\n// Function to convert to minutes\r\nfunction convertToMinutes(time: string): number | null {\r\n  // Handle military time format (HHMM) by checking for exactly 4 digits in string\r\n  if (/^\\d{4}$/.test(time)) {\r\n    // establishes hours from first 2 digist, minutes from last 2\r\n    const hours = parseInt(time.substring(0, 2));\r\n    const minutes = parseInt(time.substring(2, 4));\r\n    \r\n    // convert to minutes function\r\n    if (hours >= 0 && hours <= 23 && minutes >= 0 && minutes <= 59) {\r\n      return hours * 60 + minutes;\r\n    }\r\n  }\r\n  \r\n  // Handle HH:MM format\r\n  const match = time.match(/^(\\d{1,2}):(\\d{2})$/);\r\n  if (match) {\r\n    const hours = parseInt(match[1]);\r\n    const minutes = parseInt(match[2]);\r\n    \r\n    //valudate and return total minutes\r\n    if (hours >= 0 && hours <= 23 && minutes >= 0 && minutes <= 59) {\r\n      return hours * 60 + minutes;\r\n    }\r\n  }\r\n\r\n  return null;\r\n} ","import React, { useState, useEffect } from 'react';\r\nimport './DateCalendar.css';\r\n\r\ninterface DateCalendarProps {\r\n  savedDates: string[];\r\n  onDateSelect: (dateRange: string) => void;\r\n  onClose: () => void;\r\n}\r\n\r\nexport const DateCalendar: React.FC<DateCalendarProps> = ({ savedDates, onDateSelect, onClose }) => {\r\n  const [currentDate, setCurrentDate] = useState(new Date());\r\n  const [selectedDate, setSelectedDate] = useState<Date | null>(null);\r\n  const [calendarDays, setCalendarDays] = useState<Date[]>([]);\r\n\r\n  // Generate calendar days for the current month\r\n  useEffect(() => {\r\n    const year = currentDate.getFullYear();\r\n    const month = currentDate.getMonth();\r\n    const firstDay = new Date(year, month, 1);\r\n    const lastDay = new Date(year, month + 1, 0);\r\n    \r\n    // Get the day of the week for the first day (0 = Sunday, 6 = Saturday)\r\n    const firstDayOfWeek = firstDay.getDay();\r\n    \r\n    // Calculate the number of days to show from the previous month\r\n    const daysFromPrevMonth = firstDayOfWeek;\r\n    \r\n    // Calculate the number of days to show from the next month\r\n    const totalDays = 35; // 5 rows * 7 days\r\n    const daysFromNextMonth = totalDays - (lastDay.getDate() + daysFromPrevMonth);\r\n    \r\n    const days: Date[] = [];\r\n    \r\n    // Add days from previous month\r\n    for (let i = daysFromPrevMonth - 1; i >= 0; i--) {\r\n      days.push(new Date(year, month, -i));\r\n    }\r\n    \r\n    // Add days from current month\r\n    for (let i = 1; i <= lastDay.getDate(); i++) {\r\n      days.push(new Date(year, month, i));\r\n    }\r\n    \r\n    // Add days from next month\r\n    for (let i = 1; i <= daysFromNextMonth; i++) {\r\n      days.push(new Date(year, month + 1, i));\r\n    }\r\n    \r\n    setCalendarDays(days);\r\n  }, [currentDate]);\r\n\r\n  const handlePrevMonth = () => {\r\n    setCurrentDate(new Date(currentDate.getFullYear(), currentDate.getMonth() - 1, 1));\r\n  };\r\n\r\n  const handleNextMonth = () => {\r\n    setCurrentDate(new Date(currentDate.getFullYear(), currentDate.getMonth() + 1, 1));\r\n  };\r\n\r\n  const handleDateClick = (date: Date) => {\r\n    setSelectedDate(date);\r\n    // Find if there's a saved date range that includes this date\r\n    const dateStr = date.toISOString().split('T')[0];\r\n    const matchingDateRange = savedDates.find(range => {\r\n      const [start, end] = range.split(' to ');\r\n      return dateStr >= start && dateStr <= end;\r\n    });\r\n    \r\n    if (matchingDateRange) {\r\n      onDateSelect(matchingDateRange);\r\n      onClose();\r\n    }\r\n  };\r\n\r\n  const isDateSaved = (date: Date) => {\r\n    const dateStr = date.toISOString().split('T')[0];\r\n    return savedDates.some(range => {\r\n      const [start, end] = range.split(' to ');\r\n      return dateStr >= start && dateStr <= end;\r\n    });\r\n  };\r\n\r\n  const isCurrentMonth = (date: Date) => {\r\n    return date.getMonth() === currentDate.getMonth();\r\n  };\r\n\r\n  return (\r\n    <div className=\"date-calendar-modal\">\r\n      <div className=\"date-calendar-content\">\r\n        <div className=\"date-calendar-header\">\r\n          <button onClick={handlePrevMonth}>&lt;</button>\r\n          <h3>{currentDate.toLocaleString('default', { month: 'long', year: 'numeric' })}</h3>\r\n          <button onClick={handleNextMonth}>&gt;</button>\r\n        </div>\r\n        <div className=\"date-calendar-grid\">\r\n          <div className=\"date-calendar-weekdays\">\r\n            {['Sun', 'Mon', 'Tue', 'Wed', 'Thu', 'Fri', 'Sat'].map(day => (\r\n              <div key={day} className=\"date-calendar-weekday\">{day}</div>\r\n            ))}\r\n          </div>\r\n          <div className=\"date-calendar-days\">\r\n            {calendarDays.map((date, index) => (\r\n              <div\r\n                key={index}\r\n                className={`date-calendar-day ${\r\n                  !isCurrentMonth(date) ? 'other-month' : ''\r\n                } ${isDateSaved(date) ? 'has-entry' : ''} ${\r\n                  selectedDate?.toDateString() === date.toDateString() ? 'selected' : ''\r\n                }`}\r\n                onClick={() => handleDateClick(date)}\r\n              >\r\n                {date.getDate()}\r\n              </div>\r\n            ))}\r\n          </div>\r\n        </div>\r\n        <button className=\"date-calendar-close\" onClick={onClose}>Close</button>\r\n      </div>\r\n    </div>\r\n  );\r\n}; ","import React, { useEffect, useState, useRef } from 'react';\r\nimport { listPDFs, deletePDF, getPDF, storePDF } from '../utils/pdfStorage';\r\nimport { PDFDocument } from 'pdf-lib';\r\n\r\ninterface StoredPDF {\r\n  id: string;\r\n  pdf: Blob;\r\n  metadata: {\r\n    filename: string;\r\n    date: string;\r\n    crewNumber: string;\r\n    fireName: string;\r\n    fireNumber: string;\r\n  };\r\n  timestamp: string;\r\n}\r\n\r\ninterface Point {\r\n  x: number;\r\n  y: number;\r\n}\r\n\r\ntype SortField = 'date' | 'crewNumber' | 'fireName' | 'timestamp';\r\ntype SortDirection = 'asc' | 'desc';\r\n\r\nexport default function StoredPDFs() {\r\n  const [pdfs, setPdfs] = useState<StoredPDF[]>([]);\r\n  const [loading, setLoading] = useState(true);\r\n  const [error, setError] = useState<string | null>(null);\r\n  const [selectedPDF, setSelectedPDF] = useState<StoredPDF | null>(null);\r\n  const [pdfUrl, setPdfUrl] = useState<string | null>(null);\r\n  const [sortField, setSortField] = useState<SortField>('timestamp');\r\n  const [sortDirection, setSortDirection] = useState<SortDirection>('desc');\r\n  const [isDrawing, setIsDrawing] = useState(false);\r\n  const [drawingMode, setDrawingMode] = useState(false);\r\n  const [canvasSize, setCanvasSize] = useState({ width: 800, height: 1000 });\r\n  \r\n  const canvasRef = useRef<HTMLCanvasElement>(null);\r\n  const contextRef = useRef<CanvasRenderingContext2D | null>(null);\r\n  const lastPoint = useRef<Point | null>(null);\r\n  const pdfViewerRef = useRef<HTMLDivElement>(null);\r\n\r\n  // Initialize canvas context and handle resize\r\n  useEffect(() => {\r\n    if (canvasRef.current && drawingMode) {\r\n      const canvas = canvasRef.current;\r\n      const context = canvas.getContext('2d');\r\n      \r\n      if (context) {\r\n        context.strokeStyle = 'black';\r\n        context.lineWidth = 2;\r\n        context.lineCap = 'round';\r\n        contextRef.current = context;\r\n      }\r\n\r\n      // Update canvas size based on PDF viewer size\r\n      const updateCanvasSize = () => {\r\n        if (pdfViewerRef.current) {\r\n          const { width, height } = pdfViewerRef.current.getBoundingClientRect();\r\n          setCanvasSize({ width, height });\r\n          canvas.width = width;\r\n          canvas.height = height;\r\n          \r\n          // Restore context properties after resize\r\n          if (context) {\r\n            context.strokeStyle = 'black';\r\n            context.lineWidth = 2;\r\n            context.lineCap = 'round';\r\n          }\r\n        }\r\n      };\r\n\r\n      // Initial size update\r\n      updateCanvasSize();\r\n\r\n      // Add resize listener\r\n      const resizeObserver = new ResizeObserver(updateCanvasSize);\r\n      if (pdfViewerRef.current) {\r\n        resizeObserver.observe(pdfViewerRef.current);\r\n      }\r\n\r\n      return () => {\r\n        resizeObserver.disconnect();\r\n      };\r\n    }\r\n  }, [drawingMode]);\r\n\r\n  // Cleanup function for URL objects\r\n  useEffect(() => {\r\n    return () => {\r\n      if (pdfUrl) {\r\n        URL.revokeObjectURL(pdfUrl);\r\n      }\r\n    };\r\n  }, [pdfUrl]);\r\n\r\n  const startDrawing = (event: React.MouseEvent<HTMLCanvasElement> | React.TouchEvent<HTMLCanvasElement>) => {\r\n    if (!drawingMode) return;\r\n    \r\n    setIsDrawing(true);\r\n    const canvas = canvasRef.current;\r\n    if (!canvas) return;\r\n\r\n    const rect = canvas.getBoundingClientRect();\r\n    const point = getEventPoint(event, rect);\r\n    \r\n    lastPoint.current = point;\r\n    \r\n    const context = contextRef.current;\r\n    if (context) {\r\n      context.beginPath();\r\n      context.moveTo(point.x, point.y);\r\n    }\r\n  };\r\n\r\n  const draw = (event: React.MouseEvent<HTMLCanvasElement> | React.TouchEvent<HTMLCanvasElement>) => {\r\n    if (!isDrawing || !drawingMode) return;\r\n    \r\n    const canvas = canvasRef.current;\r\n    if (!canvas) return;\r\n\r\n    const rect = canvas.getBoundingClientRect();\r\n    const point = getEventPoint(event, rect);\r\n    \r\n    const context = contextRef.current;\r\n    if (context && lastPoint.current) {\r\n      context.beginPath();\r\n      context.moveTo(lastPoint.current.x, lastPoint.current.y);\r\n      context.lineTo(point.x, point.y);\r\n      context.stroke();\r\n    }\r\n    \r\n    lastPoint.current = point;\r\n  };\r\n\r\n  const stopDrawing = () => {\r\n    setIsDrawing(false);\r\n    lastPoint.current = null;\r\n  };\r\n\r\n  const getEventPoint = (\r\n    event: React.MouseEvent<HTMLCanvasElement> | React.TouchEvent<HTMLCanvasElement>,\r\n    rect: DOMRect\r\n  ): Point => {\r\n    if ('touches' in event) {\r\n      const touch = event.touches[0];\r\n      return {\r\n        x: touch.clientX - rect.left,\r\n        y: touch.clientY - rect.top\r\n      };\r\n    } else {\r\n      return {\r\n        x: event.clientX - rect.left,\r\n        y: event.clientY - rect.top\r\n      };\r\n    }\r\n  };\r\n\r\n  const clearDrawing = () => {\r\n    const context = contextRef.current;\r\n    const canvas = canvasRef.current;\r\n    if (context && canvas) {\r\n      context.clearRect(0, 0, canvas.width, canvas.height);\r\n    }\r\n  };\r\n\r\n  const saveDrawing = async () => {\r\n    if (!selectedPDF || !canvasRef.current) return;\r\n\r\n    try {\r\n      setLoading(true);\r\n      setError(null);\r\n\r\n      // Get the drawing as a PNG\r\n      const canvas = canvasRef.current;\r\n      const drawingBlob = await new Promise<Blob>((resolve) => {\r\n        canvas.toBlob((blob) => {\r\n          resolve(blob!);\r\n        }, 'image/png');\r\n      });\r\n\r\n      // Load the original PDF\r\n      const pdfArrayBuffer = await selectedPDF.pdf.arrayBuffer();\r\n      const pdfDoc = await PDFDocument.load(pdfArrayBuffer);\r\n      \r\n      // Convert PNG to PDF-compatible format\r\n      const drawingImage = await pdfDoc.embedPng(await drawingBlob.arrayBuffer());\r\n      \r\n      // Get the first page\r\n      const page = pdfDoc.getPages()[0];\r\n      const { width, height } = page.getSize();\r\n\r\n      // Add the drawing to the PDF\r\n      page.drawImage(drawingImage, {\r\n        x: 0,\r\n        y: 0,\r\n        width,\r\n        height,\r\n        opacity: 0.8\r\n      });\r\n\r\n      // Save the modified PDF\r\n      const modifiedPdfBytes = await pdfDoc.save();\r\n      const modifiedPdfBlob = new Blob([modifiedPdfBytes], { type: 'application/pdf' });\r\n\r\n      // Store the modified PDF\r\n      await storePDF(modifiedPdfBlob, selectedPDF.metadata);\r\n      \r\n      // Refresh the PDF list\r\n      await refreshPDFs();\r\n      \r\n      // Clear the drawing\r\n      clearDrawing();\r\n      setDrawingMode(false);\r\n\r\n    } catch (error) {\r\n      console.error('Error saving drawing:', error);\r\n      setError('Failed to save drawing. Please try again.');\r\n    } finally {\r\n      setLoading(false);\r\n    }\r\n  };\r\n\r\n  const refreshPDFs = async () => {\r\n    try {\r\n      console.log('Refreshing PDFs...');\r\n      setLoading(true);\r\n      setError(null);\r\n      const storedPDFs = await listPDFs();\r\n      console.log('Refreshed PDFs:', storedPDFs);\r\n      setPdfs(storedPDFs);\r\n      \r\n      // If we have a selected PDF, update it with the refreshed data\r\n      if (selectedPDF) {\r\n        const updatedPDF = storedPDFs.find(pdf => pdf.id === selectedPDF.id);\r\n        if (updatedPDF) {\r\n          setSelectedPDF(updatedPDF);\r\n        }\r\n      }\r\n    } catch (error) {\r\n      console.error('Error refreshing PDFs:', error);\r\n      setError('Failed to refresh PDFs. Please try again.');\r\n    } finally {\r\n      setLoading(false);\r\n    }\r\n  };\r\n\r\n  useEffect(() => {\r\n    console.log('StoredPDFs component mounted');\r\n    refreshPDFs();\r\n  }, []);\r\n\r\n  const handleSort = (field: SortField) => {\r\n    if (field === sortField) {\r\n      setSortDirection(sortDirection === 'asc' ? 'desc' : 'asc');\r\n    } else {\r\n      setSortField(field);\r\n      setSortDirection('desc');\r\n    }\r\n  };\r\n\r\n  const sortedPDFs = [...pdfs].sort((a, b) => {\r\n    let comparison = 0;\r\n    \r\n    switch (sortField) {\r\n      case 'date':\r\n        comparison = a.metadata.date.localeCompare(b.metadata.date);\r\n        break;\r\n      case 'crewNumber':\r\n        comparison = a.metadata.crewNumber.localeCompare(b.metadata.crewNumber);\r\n        break;\r\n      case 'fireName':\r\n        comparison = a.metadata.fireName.localeCompare(b.metadata.fireName);\r\n        break;\r\n      case 'timestamp':\r\n        comparison = new Date(a.timestamp).getTime() - new Date(b.timestamp).getTime();\r\n        break;\r\n    }\r\n    \r\n    return sortDirection === 'asc' ? comparison : -comparison;\r\n  });\r\n\r\n  const handleOpen = async (pdf: StoredPDF) => {\r\n    try {\r\n      console.log('Opening PDF:', pdf.metadata.filename);\r\n      \r\n      // Clean up previous URL if it exists\r\n      if (pdfUrl) {\r\n        URL.revokeObjectURL(pdfUrl);\r\n      }\r\n      \r\n      // Create a new URL for the PDF blob\r\n      const url = URL.createObjectURL(pdf.pdf);\r\n      setPdfUrl(url);\r\n      setSelectedPDF(pdf);\r\n      setError(null);\r\n      \r\n      // Don't reset drawing mode when opening a new PDF\r\n      if (drawingMode) {\r\n        clearDrawing();\r\n      }\r\n    } catch (error) {\r\n      console.error('Error opening PDF:', error);\r\n      setError('Failed to open PDF. Please try again.');\r\n    }\r\n  };\r\n\r\n  const handleClose = () => {\r\n    if (pdfUrl) {\r\n      URL.revokeObjectURL(pdfUrl);\r\n      setPdfUrl(null);\r\n    }\r\n    setSelectedPDF(null);\r\n  };\r\n\r\n  const handleDownload = async (id: string) => {\r\n    try {\r\n      console.log('Downloading PDF:', id);\r\n      const pdf = await getPDF(id);\r\n      if (pdf) {\r\n        const url = URL.createObjectURL(pdf.pdf);\r\n        const a = document.createElement('a');\r\n        a.href = url;\r\n        a.download = pdf.metadata.filename;\r\n        a.click();\r\n        URL.revokeObjectURL(url);\r\n      } else {\r\n        console.error('PDF not found:', id);\r\n        setError('PDF not found. It may have been deleted.');\r\n      }\r\n    } catch (error) {\r\n      console.error('Error downloading PDF:', error);\r\n      setError('Failed to download PDF. Please try again.');\r\n    }\r\n  };\r\n\r\n  const handleDelete = async (id: string) => {\r\n    try {\r\n      console.log('Deleting PDF:', id);\r\n      await deletePDF(id);\r\n      if (selectedPDF?.id === id) {\r\n        handleClose();\r\n      }\r\n      await refreshPDFs();\r\n    } catch (error) {\r\n      console.error('Error deleting PDF:', error);\r\n      setError('Failed to delete PDF. Please try again.');\r\n    }\r\n  };\r\n\r\n  if (loading) {\r\n    return <div className=\"stored-pdfs\">Loading stored PDFs...</div>;\r\n  }\r\n\r\n  if (error) {\r\n    return (\r\n      <div className=\"stored-pdfs\">\r\n        <div className=\"error-message\">{error}</div>\r\n        <button onClick={refreshPDFs}>Retry</button>\r\n      </div>\r\n    );\r\n  }\r\n\r\n  return (\r\n    <div className=\"stored-pdfs\">\r\n      <div className=\"stored-pdfs-header\">\r\n        <h3>Stored PDFs</h3>\r\n        <button onClick={refreshPDFs} className=\"refresh-btn\">Refresh</button>\r\n      </div>\r\n      \r\n      <div className=\"stored-pdfs-container\">\r\n        {/* PDF List Panel */}\r\n        <div className=\"pdf-list-panel\">\r\n          {pdfs.length === 0 ? (\r\n            <p>No PDFs stored yet. Generate a PDF using the \"Export to PDF\" button above.</p>\r\n          ) : (\r\n            <div className=\"pdf-list\">\r\n              <div className=\"pdf-list-header\">\r\n                <button \r\n                  className={`sort-btn ${sortField === 'date' ? 'active' : ''}`}\r\n                  onClick={() => handleSort('date')}\r\n                >\r\n                  Date {sortField === 'date' && (sortDirection === 'asc' ? '↑' : '↓')}\r\n                </button>\r\n                <button \r\n                  className={`sort-btn ${sortField === 'crewNumber' ? 'active' : ''}`}\r\n                  onClick={() => handleSort('crewNumber')}\r\n                >\r\n                  Crew {sortField === 'crewNumber' && (sortDirection === 'asc' ? '↑' : '↓')}\r\n                </button>\r\n                <button \r\n                  className={`sort-btn ${sortField === 'fireName' ? 'active' : ''}`}\r\n                  onClick={() => handleSort('fireName')}\r\n                >\r\n                  Fire {sortField === 'fireName' && (sortDirection === 'asc' ? '↑' : '↓')}\r\n                </button>\r\n                <button \r\n                  className={`sort-btn ${sortField === 'timestamp' ? 'active' : ''}`}\r\n                  onClick={() => handleSort('timestamp')}\r\n                >\r\n                  Stored {sortField === 'timestamp' && (sortDirection === 'asc' ? '↑' : '↓')}\r\n                </button>\r\n              </div>\r\n              {sortedPDFs.map((pdf) => (\r\n                <div key={pdf.id} className={`pdf-item ${selectedPDF?.id === pdf.id ? 'selected' : ''}`}>\r\n                  <div className=\"pdf-info\">\r\n                    <strong>{pdf.metadata.filename}</strong>\r\n                    <div>Date: {pdf.metadata.date}</div>\r\n                    <div>Crew: {pdf.metadata.crewNumber}</div>\r\n                    <div>Fire: {pdf.metadata.fireName} ({pdf.metadata.fireNumber})</div>\r\n                    <div>Stored: {new Date(pdf.timestamp).toLocaleString()}</div>\r\n                  </div>\r\n                  <div className=\"pdf-actions\">\r\n                    <button onClick={() => handleOpen(pdf)} className=\"open-btn\">\r\n                      {selectedPDF?.id === pdf.id ? 'Viewing' : 'View'}\r\n                    </button>\r\n                    <button onClick={() => handleDownload(pdf.id)} className=\"download-btn\">Download</button>\r\n                    <button onClick={() => handleDelete(pdf.id)} className=\"delete-btn\">Delete</button>\r\n                  </div>\r\n                </div>\r\n              ))}\r\n            </div>\r\n          )}\r\n        </div>\r\n\r\n        {/* PDF Viewer Panel */}\r\n        {selectedPDF && pdfUrl && (\r\n          <div className=\"pdf-viewer-panel\">\r\n            <div className=\"pdf-viewer-header\">\r\n              <div className=\"pdf-viewer-title\">\r\n                <h4>{selectedPDF.metadata.filename}</h4>\r\n              </div>\r\n              <div className=\"pdf-viewer-actions\">\r\n                <button \r\n                  onClick={() => setDrawingMode(!drawingMode)} \r\n                  className={`draw-btn ${drawingMode ? 'active' : ''}`}\r\n                >\r\n                  {drawingMode ? 'Cancel Drawing' : 'Draw'}\r\n                </button>\r\n                {drawingMode && (\r\n                  <>\r\n                    <button onClick={clearDrawing} className=\"clear-btn\">\r\n                      Clear\r\n                    </button>\r\n                    <button onClick={saveDrawing} className=\"save-btn\">\r\n                      Save\r\n                    </button>\r\n                  </>\r\n                )}\r\n                <button onClick={handleClose} className=\"close-btn\">Close</button>\r\n              </div>\r\n            </div>\r\n            <div className=\"pdf-viewer-content\" ref={pdfViewerRef}>\r\n              <iframe\r\n                src={pdfUrl}\r\n                title={selectedPDF.metadata.filename}\r\n                width=\"100%\"\r\n                height=\"100%\"\r\n                style={{ \r\n                  border: 'none',\r\n                  display: drawingMode ? 'none' : 'block'\r\n                }}\r\n              />\r\n              {drawingMode && (\r\n                <canvas\r\n                  ref={canvasRef}\r\n                  width={canvasSize.width}\r\n                  height={canvasSize.height}\r\n                  onMouseDown={startDrawing}\r\n                  onMouseMove={draw}\r\n                  onMouseUp={stopDrawing}\r\n                  onMouseLeave={stopDrawing}\r\n                  onTouchStart={startDrawing}\r\n                  onTouchMove={draw}\r\n                  onTouchEnd={stopDrawing}\r\n                  className=\"drawing-canvas\"\r\n                />\r\n              )}\r\n            </div>\r\n          </div>\r\n        )}\r\n      </div>\r\n    </div>\r\n  );\r\n} ","import React, { useEffect, useState } from 'react';\r\nimport { defaultData } from '../data/defaultData';\r\nimport './MainTable.css';\r\nimport { fillCTRPDF } from '../utils/fillCTRPDF';\r\nimport * as XLSX from 'xlsx';\r\nimport { fillExcelTemplate } from '../utils/fillExcelTemplate';\r\nimport { generateExportFilename } from '../utils/filenameGenerator';\r\nimport { ctrDataService } from '../utils/CTRDataService';\r\nimport { Notification } from './Notification';\r\nimport { mapExcelToData } from '../utils/excelMapping';\r\nimport { CrewMember, CrewInfo, Day } from '../types/CTRTypes';\r\nimport { calculateTotalHours } from '../utils/timeCalculations';\r\nimport { DateCalendar } from './DateCalendar';\r\nimport StoredPDFs from './StoredPDFs';\r\n\r\n// TypeScript interfaces\r\ninterface EditingCell {\r\n  row: number;\r\n  field: string;\r\n  dayIdx?: number;\r\n}\r\n\r\ninterface NotificationState {\r\n  message: string;\r\n  type: 'success' | 'info' | 'warning' | 'error';\r\n  show: boolean;\r\n}\r\n\r\nconst STORAGE_KEY = 'ctr-table-data';\r\n\r\nfunction saveData(data: CrewMember[]) {\r\n  localStorage.setItem(STORAGE_KEY, JSON.stringify(data));\r\n}\r\n\r\nfunction loadData(): CrewMember[] {\r\n  const raw = localStorage.getItem(STORAGE_KEY);\r\n  if (raw) {\r\n    try {\r\n      return JSON.parse(raw);\r\n    } catch {\r\n      return defaultData;\r\n    }\r\n  }\r\n  return defaultData;\r\n}\r\n\r\nfunction toExcelTemplate(data: CrewMember[], crewInfo: CrewInfo, days: string[]): XLSX.WorkBook {\r\n  // Create a blank worksheet with enough rows/cols\r\n  const ws: XLSX.WorkSheet = {};\r\n  // Set up the data array for AoA\r\n  const aoa: any[][] = Array.from({ length: 30 }, () => Array(9).fill(\"\"));\r\n\r\n  // Header info\r\n  aoa[0][1] = crewInfo.crewName || \"\"; // B1\r\n  aoa[0][7] = crewInfo.crewNumber || \"\"; // H1\r\n  aoa[1][1] = crewInfo.fireName || \"\"; // B2\r\n  aoa[1][7] = crewInfo.fireNumber || \"\"; // H2\r\n\r\n  // Date headers\r\n  aoa[3][5] = days[0] || \"\"; // F4\r\n  aoa[3][7] = days[1] || \"\"; // H4\r\n\r\n  // Yellow highlight row (row 6, E-H)\r\n  for (let col = 4; col <= 7; col++) aoa[5][col] = \"\";\r\n\r\n  // Table rows (6-25)\r\n  for (let i = 0; i < 20; i++) {\r\n    const row = data[i] || { name: \"\", classification: \"\", days: [{ on: \"\", off: \"\" }, { on: \"\", off: \"\" }] };\r\n    const r = 5 + i; // Excel row 6 is index 5\r\n    aoa[r][1] = row.name || \"\"; // B\r\n    aoa[r][2] = \"\"; // C (merged with B)\r\n    aoa[r][3] = row.classification || \"\"; // D\r\n    aoa[r][4] = row.days[0]?.on || \"\"; // E (date 1 ON)\r\n    aoa[r][5] = row.days[0]?.off || \"\"; // F (date 1 OFF)\r\n    aoa[r][6] = row.days[1]?.on || \"\"; // G (date 2 ON)\r\n    aoa[r][7] = row.days[1]?.off || \"\"; // H (date 2 OFF)\r\n  }\r\n\r\n  // Calculate total hours\r\n  const totalHours = calculateTotalHours(data);\r\n\r\n  // Total Hours row (row 29)\r\n  aoa[28][1] = \"Total Hours\";\r\n  aoa[28][2] = totalHours;\r\n\r\n  // Write AoA to worksheet\r\n  XLSX.utils.sheet_add_aoa(ws, aoa);\r\n\r\n  // Merge B & C for names\r\n  for (let r = 6; r <= 25; r++) {\r\n    if (!ws['!merges']) ws['!merges'] = [];\r\n    ws['!merges'].push({ s: { r: r - 1, c: 1 }, e: { r: r - 1, c: 2 } });\r\n  }\r\n\r\n  // Set column widths\r\n  ws['!cols'] = [\r\n    { wpx: 10 },   // A\r\n    { wpx: 120 },  // B (Name)\r\n    { wpx: 120 },  // C (Name merged)\r\n    { wpx: 60 },   // D (Class)\r\n    { wpx: 50 },   // E (ON 1)\r\n    { wpx: 50 },   // F (OFF 1)\r\n    { wpx: 50 },   // G (ON 2)\r\n    { wpx: 50 },   // H (OFF 2)\r\n  ];\r\n\r\n  // Highlight row 6, E-H (yellow)\r\n  for (let c = 4; c <= 7; c++) {\r\n    const cell = XLSX.utils.encode_cell({ r: 5, c });\r\n    if (!ws[cell]) ws[cell] = { t: 's', v: '' };\r\n    ws[cell].s = { fill: { fgColor: { rgb: 'FFFF00' } } };\r\n  }\r\n\r\n  // Set time format for ON/OFF cells\r\n  for (let r = 6; r <= 25; r++) {\r\n    for (let c of [4, 5, 6, 7]) {\r\n      const cell = XLSX.utils.encode_cell({ r: r - 1, c });\r\n      if (ws[cell]) ws[cell].z = 'h:mm';\r\n    }\r\n  }\r\n\r\n  // Create workbook\r\n  const wb = XLSX.utils.book_new();\r\n  XLSX.utils.book_append_sheet(wb, ws, \"Crew Time Report\");\r\n  return wb;\r\n}\r\n\r\n// Add deep comparison utility\r\nfunction deepEqual(obj1: any, obj2: any): boolean {\r\n  if (obj1 === obj2) return true;\r\n  if (typeof obj1 !== 'object' || obj1 === null || typeof obj2 !== 'object' || obj2 === null) {\r\n    return false;\r\n  }\r\n  \r\n  const keys1 = Object.keys(obj1);\r\n  const keys2 = Object.keys(obj2);\r\n  \r\n  if (keys1.length !== keys2.length) return false;\r\n  \r\n  for (const key of keys1) {\r\n    if (!keys2.includes(key)) return false;\r\n    if (!deepEqual(obj1[key], obj2[key])) return false;\r\n  }\r\n  \r\n  return true;\r\n}\r\n\r\nexport default function MainTable() {\r\n  const [data, setData] = useState<CrewMember[]>(() => {\r\n    const loadedData = loadData();\r\n    return Array.isArray(loadedData) ? loadedData : defaultData;\r\n  });\r\n  \r\n  const [dayCount, setDayCount] = useState(() => {\r\n    return data[0]?.days?.length || 2;\r\n  });\r\n  \r\n  const [days, setDays] = useState<string[]>(() => {\r\n    const loadedDates = data[0]?.days?.map(d => d.date);\r\n    return Array.isArray(loadedDates) && loadedDates.length === 2 ? loadedDates : ['', ''];\r\n  });\r\n  const [showSaveDefault, setShowSaveDefault] = useState(false);\r\n  const [crewInfo, setCrewInfo] = useState<CrewInfo>({\r\n    crewName: '',\r\n    crewNumber: '',\r\n    fireName: '',\r\n    fireNumber: ''\r\n  });\r\n  const [editingCell, setEditingCell] = useState<EditingCell | null>(null);\r\n  const [lastTap, setLastTap] = useState<number>(0);\r\n  const [savedDates, setSavedDates] = useState<string[]>([]);\r\n  const [selectedDate, setSelectedDate] = useState<string>('');\r\n  const [hasUnsavedChanges, setHasUnsavedChanges] = useState(false);\r\n  const [notification, setNotification] = useState<NotificationState>({\r\n    message: '',\r\n    type: 'info',\r\n    show: false\r\n  });\r\n\r\n  // Add state to track last saved version\r\n  const [lastSavedState, setLastSavedState] = useState({\r\n    data: data,\r\n    crewInfo: crewInfo,\r\n    days: days\r\n  });\r\n\r\n  const [currentDateIndex, setCurrentDateIndex] = useState<number>(-1);\r\n\r\n  // Calculate total hours whenever data changes\r\n  const totalHours = calculateTotalHours(data);\r\n\r\n  // Add state to track last saved version\r\n  const [lastSavedTotalHours, setLastSavedTotalHours] = useState(0);\r\n\r\n  // Add state to track last saved crew info\r\n  const [lastSavedCrewInfo, setLastSavedCrewInfo] = useState<CrewInfo>({\r\n    crewName: '',\r\n    crewNumber: '',\r\n    fireName: '',\r\n    fireNumber: ''\r\n  });\r\n\r\n  const [showCalendar, setShowCalendar] = useState(false);\r\n  const [showCustomDatePicker, setShowCustomDatePicker] = useState<number | null>(null);\r\n\r\n  // Load saved dates on component mount\r\n  useEffect(() => {\r\n    loadSavedDates();\r\n  }, []);\r\n\r\n  // Update lastSavedState when data is loaded\r\n  useEffect(() => {\r\n    setLastSavedState({\r\n      data: [...data],\r\n      crewInfo: { ...crewInfo },\r\n      days: [...days]\r\n    });\r\n  }, []);\r\n\r\n  // Update lastSavedTotalHours when data is loaded\r\n  useEffect(() => {\r\n    setLastSavedTotalHours(totalHours);\r\n  }, []);\r\n\r\n  // Replace the existing useEffect for change tracking\r\n  useEffect(() => {\r\n    // Check if we have all required crew info\r\n    const hasCrewInfo = Boolean(\r\n      crewInfo.crewName && \r\n      crewInfo.crewNumber && \r\n      crewInfo.fireName && \r\n      crewInfo.fireNumber\r\n    );\r\n\r\n    // Check if we have both dates\r\n    const hasDates = Boolean(days[0] && days[1]);\r\n\r\n    // Check if total hours have changed\r\n    const hoursChanged = Math.abs(totalHours - lastSavedTotalHours) > 0.01;\r\n\r\n    // Check if crew info has changed\r\n    const crewInfoChanged = Boolean(\r\n      crewInfo.crewName !== lastSavedCrewInfo.crewName ||\r\n      crewInfo.crewNumber !== lastSavedCrewInfo.crewNumber ||\r\n      crewInfo.fireName !== lastSavedCrewInfo.fireName ||\r\n      crewInfo.fireNumber !== lastSavedCrewInfo.fireNumber\r\n    );\r\n\r\n    // Only set hasUnsavedChanges if we have required fields and either hours or crew info changed\r\n    const hasChanges = Boolean(\r\n      (hoursChanged || crewInfoChanged) && \r\n      hasCrewInfo && \r\n      hasDates\r\n    );\r\n\r\n    setHasUnsavedChanges(hasChanges);\r\n  }, [totalHours, crewInfo, days, lastSavedTotalHours, lastSavedCrewInfo]);\r\n\r\n  const loadSavedDates = async () => {\r\n    try {\r\n      const dateRanges = await ctrDataService.getAllDateRanges();\r\n      setSavedDates(dateRanges);\r\n    } catch (error) {\r\n      console.error('Error loading saved dates:', error);\r\n    }\r\n  };\r\n\r\n  const showNotification = (message: string, type: 'success' | 'info' | 'warning' | 'error') => {\r\n    setNotification({ message, type, show: true });\r\n  };\r\n\r\n  const hideNotification = () => {\r\n    setNotification(prev => ({ ...prev, show: false }));\r\n  };\r\n\r\n  const handleSave = async () => {\r\n    if (!days[0] || !days[1]) {\r\n      showNotification('Please select both dates before saving.', 'warning');\r\n      return;\r\n    }\r\n    try {\r\n      const date1 = days[0];\r\n      const date2 = days[1];\r\n      await ctrDataService.saveRecord(date1, date2, data, crewInfo);\r\n      await loadSavedDates();\r\n      \r\n      // Update lastSavedTotalHours and lastSavedCrewInfo after successful save\r\n      setLastSavedTotalHours(totalHours);\r\n      setLastSavedCrewInfo({ ...crewInfo });\r\n      \r\n      setHasUnsavedChanges(false);\r\n      showNotification('Data saved successfully!', 'success');\r\n    } catch (error) {\r\n      console.error('Error saving data:', error);\r\n      showNotification('Failed to save data. Please try again.', 'error');\r\n    }\r\n  };\r\n\r\n  const findCurrentDateIndex = () => {\r\n    if (!selectedDate) return -1;\r\n    return savedDates.findIndex(date => date === selectedDate);\r\n  };\r\n\r\n  const handlePreviousEntry = async () => {\r\n    const currentIndex = findCurrentDateIndex();\r\n    if (currentIndex > 0) {\r\n      const prevDateRange = savedDates[currentIndex - 1];\r\n      // Reset unsaved changes state before loading new data\r\n      setHasUnsavedChanges(false);\r\n      await handleDateSelect(prevDateRange);\r\n    }\r\n  };\r\n\r\n  const handleNextEntry = async () => {\r\n    const currentIndex = findCurrentDateIndex();\r\n    if (currentIndex < savedDates.length - 1) {\r\n      const nextDateRange = savedDates[currentIndex + 1];\r\n      // Reset unsaved changes state before loading new data\r\n      setHasUnsavedChanges(false);\r\n      await handleDateSelect(nextDateRange);\r\n    }\r\n  };\r\n\r\n  const handleDateSelect = async (dateRange: string) => {\r\n    if (dateRange === \"new\") {\r\n      if (hasUnsavedChanges) {\r\n        showNotification('You have unsaved changes. Please save or discard them before starting a new entry.', 'warning');\r\n        return;\r\n      }\r\n      setData(defaultData);\r\n      setCrewInfo({\r\n        crewName: '',\r\n        crewNumber: '',\r\n        fireName: '',\r\n        fireNumber: ''\r\n      });\r\n      setDays(['', '']);\r\n      setSelectedDate('');\r\n      setCurrentDateIndex(-1);\r\n      setHasUnsavedChanges(false);\r\n      setLastSavedTotalHours(0);\r\n      setLastSavedCrewInfo({\r\n        crewName: '',\r\n        crewNumber: '',\r\n        fireName: '',\r\n        fireNumber: ''\r\n      });\r\n      showNotification('New entry started', 'info');\r\n      return;\r\n    }\r\n\r\n    if (hasUnsavedChanges) {\r\n      showNotification('You have unsaved changes. Please save or discard them before loading another date range.', 'warning');\r\n      return;\r\n    }\r\n\r\n    try {\r\n      const record = await ctrDataService.getRecord(dateRange);\r\n      if (record) {\r\n        setData(record.data);\r\n        setCrewInfo(record.crewInfo);\r\n        const [date1, date2] = record.dateRange.split(' to ');\r\n        setDays([date1, date2]);\r\n        setSelectedDate(dateRange);\r\n        setCurrentDateIndex(savedDates.indexOf(dateRange));\r\n        setHasUnsavedChanges(false);\r\n        \r\n        // Update lastSavedTotalHours and lastSavedCrewInfo with the loaded data\r\n        const loadedTotalHours = calculateTotalHours(record.data);\r\n        setLastSavedTotalHours(loadedTotalHours);\r\n        setLastSavedCrewInfo({ ...record.crewInfo });\r\n        \r\n        showNotification('Data loaded successfully', 'success');\r\n      }\r\n    } catch (error) {\r\n      console.error('Error loading selected date range:', error);\r\n      showNotification('Failed to load data. Please try again.', 'error');\r\n    }\r\n  };\r\n\r\n  useEffect(() => {\r\n    saveData(data);\r\n  }, [data]);\r\n\r\n  const handleCellDoubleTap = (rowIdx: number, field: string, dayIdx?: number) => {\r\n    const now = Date.now();\r\n    if (now - lastTap < 300) { // Double tap detected\r\n      setEditingCell({ row: rowIdx, field, dayIdx });\r\n    }\r\n    setLastTap(now);\r\n  };\r\n\r\n  const handleCellDoubleClick = (rowIdx: number, field: string, dayIdx?: number) => {\r\n    setEditingCell({ row: rowIdx, field, dayIdx });\r\n  };\r\n\r\n  const validateMilitaryTime = (value: string): boolean => {\r\n    if (!value) return true;\r\n    \r\n    // Must be exactly 4 digits\r\n    if (value.length > 4) return false;\r\n    \r\n    // Convert to array of digits\r\n    const digits = value.split('').map(Number);\r\n    \r\n    // First digit must be 0-2\r\n    if (digits[0] > 2) return false;\r\n    \r\n    // Second digit rules based on first digit\r\n    if (digits[0] === 2 && digits[1] > 3) return false;\r\n    \r\n    // Third digit must be 0-5\r\n    if (digits[2] > 5) return false;\r\n    \r\n    return true;\r\n  };\r\n\r\n  const copyFFTTimes = () => {\r\n    // Find the first FFT1 or FFT2 entry\r\n    const fftIndex = data.findIndex(member => \r\n      member.classification?.toUpperCase().includes('FFT1') || \r\n      member.classification?.toUpperCase().includes('FFT2')\r\n    );\r\n\r\n    if (fftIndex === -1) {\r\n      alert('Please enter an FFT1 or FFT2 classification first.');\r\n      return;\r\n    }\r\n\r\n    if (!data[fftIndex].name) {\r\n      alert('Please enter the FFT name first.');\r\n      return;\r\n    }\r\n\r\n    const fftTimes = data[fftIndex].days;\r\n    const newData = data.map((member, index) => {\r\n      if (index <= fftIndex) return member; // Skip crew boss and FFT\r\n      return {\r\n        ...member,\r\n        days: fftTimes.map(day => ({ ...day }))\r\n      };\r\n    });\r\n\r\n    setData(newData);\r\n    setHasUnsavedChanges(true);\r\n  };\r\n\r\n  const handleCellEdit = (e: React.ChangeEvent<HTMLInputElement>, rowIdx: number, field: string, dayIdx?: number) => {\r\n    const { value } = e.target;\r\n    \r\n    // Validate military time for on/off fields\r\n    if ((field === 'on' || field === 'off')) {\r\n      // Only allow digits\r\n      if (!/^\\d*$/.test(value)) return;\r\n      \r\n      // Apply validation rules\r\n      if (!validateMilitaryTime(value)) return;\r\n    }\r\n\r\n    const newData = [...data];\r\n    \r\n    // Ensure the row exists and has the required structure\r\n    if (!newData[rowIdx]) {\r\n      newData[rowIdx] = {\r\n        name: '',\r\n        classification: '',\r\n        days: days.map(date => ({ date, on: '', off: '' }))\r\n      };\r\n    }\r\n    \r\n    // Ensure days array exists\r\n    if (!newData[rowIdx].days) {\r\n      newData[rowIdx].days = days.map(date => ({ date, on: '', off: '' }));\r\n    }\r\n    \r\n    if (dayIdx !== undefined) {\r\n      // Ensure the day object exists\r\n      if (!newData[rowIdx].days[dayIdx]) {\r\n        newData[rowIdx].days[dayIdx] = { date: days[dayIdx] || '', on: '', off: '' };\r\n      }\r\n      newData[rowIdx].days[dayIdx][field as keyof Day] = value;\r\n\r\n      // If this is the second row (index 1) and we're editing ON/OFF times\r\n      if (rowIdx === 1) {\r\n        // Copy these times to all subsequent rows that have names\r\n        for (let i = 2; i < newData.length; i++) {\r\n          if (newData[i]?.name) {\r\n            if (!newData[i].days[dayIdx]) {\r\n              newData[i].days[dayIdx] = { date: days[dayIdx] || '', on: '', off: '' };\r\n            }\r\n            newData[i].days[dayIdx][field as keyof Day] = value;\r\n          }\r\n        }\r\n      }\r\n    } else {\r\n      (newData[rowIdx] as any)[field] = value;\r\n\r\n      // If this is a name field and it's not the first FFT1/FFT2, copy their times\r\n      if (field === 'name' && value) {\r\n        const fftIndex = newData.findIndex(member => \r\n          member?.classification?.toUpperCase().includes('FFT1') || \r\n          member?.classification?.toUpperCase().includes('FFT2')\r\n        );\r\n\r\n        if (fftIndex !== -1 && rowIdx > fftIndex && newData[fftIndex]?.days) {\r\n          const fftTimes = newData[fftIndex].days;\r\n          newData[rowIdx].days = fftTimes.map(day => ({ ...day }));\r\n        }\r\n      }\r\n    }\r\n    \r\n    setData(newData);\r\n    setHasUnsavedChanges(true);\r\n  };\r\n\r\n  const handleCellBlur = () => {\r\n    setTimeout(() => {\r\n      setEditingCell(null);\r\n    }, 200);\r\n  };\r\n\r\n  const handleDelete = (idx: number) => {\r\n    const newData = data.filter((_, i) => i !== idx);\r\n    setData(newData);\r\n  };\r\n\r\n  const handleHeaderDateChange = (e: React.ChangeEvent<HTMLInputElement>, idx: number) => {\r\n    const newDate = e.target.value;\r\n    setDays(prev => prev.map((d, i) => (i === idx ? newDate : d)));\r\n    setData(data => data.map(row => ({\r\n      ...row,\r\n      days: row.days.map((day, i) => i === idx ? { ...day, date: newDate } : day)\r\n    })));\r\n    setHasUnsavedChanges(true);\r\n  };\r\n\r\n  const handleResetToDefault = () => {\r\n    setData(defaultData);\r\n    saveData(defaultData);\r\n    setShowSaveDefault(false);\r\n    showNotification('Restored to original default data!', 'info');\r\n  };\r\n\r\n  const handleSaveDefault = () => {\r\n    saveData(data);\r\n    setShowSaveDefault(false);\r\n    showNotification('Current table saved as default!', 'success');\r\n  };\r\n\r\n  const handleExportExcel = async () => {\r\n    try {\r\n      // Validate required data before attempting Excel generation\r\n      if (!days[0] || !days[1]) {\r\n        showNotification('Please select both dates before generating Excel.', 'warning');\r\n        return;\r\n      }\r\n\r\n      if (!crewInfo.crewNumber || !crewInfo.fireName || !crewInfo.fireNumber) {\r\n        showNotification('Please fill in all crew and fire information before generating Excel.', 'warning');\r\n        return;\r\n      }\r\n\r\n      // Check if there's any crew member data\r\n      const hasCrewData = data.some(member => \r\n        member.name && member.classification && \r\n        member.days.some(day => day.on || day.off)\r\n      );\r\n\r\n      if (!hasCrewData) {\r\n        showNotification('Please enter at least one crew member\\'s information before generating Excel.', 'warning');\r\n        return;\r\n      }\r\n\r\n      showNotification('Generating Excel...', 'info');\r\n      \r\n      const wb = await fillExcelTemplate(data, crewInfo, days, '/CTR_Template.xlsx');\r\n      XLSX.writeFile(wb, generateExportFilename({\r\n        date: days[0],\r\n        crewNumber: crewInfo.crewNumber,\r\n        fireName: crewInfo.fireName,\r\n        fireNumber: crewInfo.fireNumber,\r\n        type: 'Excel'\r\n      }));\r\n      showNotification('Excel file generated successfully!', 'success');\r\n    } catch (error) {\r\n      console.error('Error generating Excel:', error);\r\n      let errorMessage = 'Failed to generate Excel file. ';\r\n      \r\n      if (error instanceof Error) {\r\n        if (error.message.includes('network') || error.message.includes('fetch')) {\r\n          errorMessage += 'Please check your internet connection and try again.';\r\n        } else if (error.message.includes('template')) {\r\n          errorMessage += 'The Excel template could not be loaded. Please try refreshing the page.';\r\n        } else {\r\n          errorMessage += 'An unexpected error occurred. Please try again.';\r\n        }\r\n      }\r\n      \r\n      showNotification(errorMessage, 'error');\r\n    }\r\n  };\r\n\r\n  const handleExportPDF = async () => {\r\n    try {\r\n      // Validate required data before attempting PDF generation\r\n      if (!days[0] || !days[1]) {\r\n        showNotification('Please select both dates before generating PDF.', 'warning');\r\n        return;\r\n      }\r\n\r\n      if (!crewInfo.crewNumber || !crewInfo.fireName || !crewInfo.fireNumber) {\r\n        showNotification('Please fill in all crew and fire information before generating PDF.', 'warning');\r\n        return;\r\n      }\r\n\r\n      // Check if there's any crew member data\r\n      const hasCrewData = data.some(member => \r\n        member.name && member.classification && \r\n        member.days.some(day => day.on || day.off)\r\n      );\r\n\r\n      if (!hasCrewData) {\r\n        showNotification('Please enter at least one crew member\\'s information before generating PDF.', 'warning');\r\n        return;\r\n      }\r\n\r\n      showNotification('Generating PDF...', 'info');\r\n      \r\n      try {\r\n        await fillCTRPDF(data, crewInfo, undefined);\r\n        showNotification('PDF generated successfully!', 'success');\r\n      } catch (error) {\r\n        // error handling\r\n        console.error('Error generating PDF:', error);\r\n        let errorMessage = 'Failed to generate PDF. ';\r\n        \r\n        if (error instanceof Error) {\r\n          if (error.message.includes('network') || error.message.includes('fetch')) {\r\n            errorMessage += 'Please check your internet connection and try again.';\r\n          } else if (error.message.includes('cache')) {\r\n            errorMessage += 'The PDF template could not be loaded. Please try refreshing the page.';\r\n          } else {\r\n            errorMessage += 'An unexpected error occurred. Please try again.';\r\n          }\r\n        }\r\n        \r\n        showNotification(errorMessage, 'error');\r\n      }\r\n    } catch (error) {\r\n      console.error('Error in PDF generation process:', error);\r\n      showNotification('An unexpected error occurred while preparing the PDF.', 'error');\r\n    }\r\n  };\r\n\r\n  const handleExcelUpload = (e: React.ChangeEvent<HTMLInputElement>) => {\r\n    const file = e.target.files?.[0];\r\n    if (!file) return;\r\n    \r\n    const reader = new FileReader();\r\n    reader.onload = (evt) => {\r\n      try {\r\n        const data = evt.target?.result;\r\n        const workbook = XLSX.read(data, { type: 'binary' });\r\n        const sheetName = workbook.SheetNames[0];\r\n        const worksheet = workbook.Sheets[sheetName];\r\n        \r\n        // Use the mapping utility to extract data\r\n        const { crewInfo: importedCrewInfo, crewMembers } = mapExcelToData(worksheet);\r\n        \r\n        // Update the application state\r\n        setCrewInfo(importedCrewInfo);\r\n        setData(crewMembers);\r\n        \r\n        // Extract dates from the first crew member's days\r\n        if (crewMembers.length > 0) {\r\n          const dates = crewMembers[0].days.map(d => d.date);\r\n          setDays(dates);\r\n          setDayCount(dates.length);\r\n        }\r\n        \r\n        setShowSaveDefault(true);\r\n        showNotification('Excel file imported successfully', 'success');\r\n      } catch (error) {\r\n        console.error('Error importing Excel file:', error);\r\n        showNotification('Error importing Excel file. Please check the file format.', 'error');\r\n      }\r\n    };\r\n    reader.readAsBinaryString(file);\r\n  };\r\n\r\n  const handleCopyToNextDay = async () => {\r\n    if (!days[0] || !days[1]) {\r\n      showNotification('Please set both dates before copying to next days.', 'warning');\r\n      return;\r\n    }\r\n\r\n    // Validate that we have crew data\r\n    const hasCrewData = data.some(member => \r\n      member.name && member.classification\r\n    );\r\n\r\n    if (!hasCrewData) {\r\n      showNotification('Please enter crew information before copying to next days.', 'warning');\r\n      return;\r\n    }\r\n\r\n    try {\r\n      showNotification('Copying data to next 20 days...', 'info');\r\n      \r\n      // Get the base dates\r\n      const startDate = new Date(days[0]);\r\n      const endDate = new Date(days[1]);\r\n      const daysDiff = Math.ceil((endDate.getTime() - startDate.getTime()) / (1000 * 60 * 60 * 24));\r\n\r\n      // Copy data for next 20 days\r\n      for (let i = 0; i < 20; i++) {\r\n        // Calculate new date range starting from the day after date2\r\n        const newStartDate = new Date(endDate);\r\n        newStartDate.setDate(newStartDate.getDate() + 1 + (i * (daysDiff + 1)));\r\n        \r\n        const newEndDate = new Date(newStartDate);\r\n        newEndDate.setDate(newEndDate.getDate() + daysDiff);\r\n\r\n        const newStartDateStr = newStartDate.toISOString().split('T')[0];\r\n        const newEndDateStr = newEndDate.toISOString().split('T')[0];\r\n\r\n        // Create new data with updated dates but empty time entries\r\n        const newData = data.map(member => ({\r\n          name: member.name,\r\n          classification: member.classification,\r\n          days: [\r\n            { date: newStartDateStr, on: '', off: '' },\r\n            { date: newEndDateStr, on: '', off: '' }\r\n          ]\r\n        }));\r\n\r\n        // Save the new date range\r\n        await ctrDataService.saveRecord(newStartDateStr, newEndDateStr, newData, crewInfo);\r\n      }\r\n\r\n      // Reload saved dates\r\n      await loadSavedDates();\r\n      setCurrentDateIndex(findCurrentDateIndex());\r\n      showNotification('Successfully copied crew information to next 20 days!', 'success');\r\n    } catch (error) {\r\n      console.error('Error copying data to next days:', error);\r\n      showNotification('Failed to copy data to next days. Please try again.', 'error');\r\n    }\r\n  };\r\n\r\n  const handleRemoveEntry = async () => {\r\n    if (!selectedDate) {\r\n      showNotification('Please select a date range to remove.', 'warning');\r\n      return;\r\n    }\r\n\r\n    if (hasUnsavedChanges) {\r\n      showNotification('Please save or discard your changes before removing an entry.', 'warning');\r\n      return;\r\n    }\r\n\r\n    try {\r\n      await ctrDataService.deleteRecord(selectedDate);\r\n      await loadSavedDates();\r\n      setSelectedDate('');\r\n      setCurrentDateIndex(-1);\r\n      setData(defaultData);\r\n      setCrewInfo({\r\n        crewName: '',\r\n        crewNumber: '',\r\n        fireName: '',\r\n        fireNumber: ''\r\n      });\r\n      setDays(['', '']);\r\n      showNotification('Entry removed successfully', 'success');\r\n    } catch (error) {\r\n      console.error('Error removing entry:', error);\r\n      showNotification('Failed to remove entry. Please try again.', 'error');\r\n    }\r\n  };\r\n\r\n  return (\r\n    <div className=\"ctr-container\">\r\n      {notification.show && (\r\n        <Notification\r\n          message={notification.message}\r\n          type={notification.type}\r\n          onClose={hideNotification}\r\n        />\r\n      )}\r\n      <h2 className=\"ctr-title\">Crew Time Report Table</h2>\r\n      \r\n      {/* Date Selection and Save Controls */}\r\n      <div className=\"ctr-date-controls\">\r\n        <div className=\"ctr-date-selector\">\r\n          <select \r\n            value={selectedDate}\r\n            onChange={(e) => handleDateSelect(e.target.value)}\r\n            className=\"ctr-select\"\r\n          >\r\n            <option value=\"new\">New Entry</option>\r\n            <option value=\"\">Select a saved date range...</option>\r\n            {savedDates.map(dateRange => {\r\n              const [date1, date2] = dateRange.split(' to ');\r\n              return (\r\n                <option key={dateRange} value={dateRange}>\r\n                  {date1} to {date2}\r\n                </option>\r\n              );\r\n            })}\r\n          </select>\r\n          <button \r\n            className=\"ctr-btn calendar-btn\"\r\n            onClick={() => setShowCalendar(true)}\r\n            title=\"Open Calendar View\"\r\n          >\r\n            📅\r\n          </button>\r\n        </div>\r\n        <div className=\"ctr-navigation-buttons\">\r\n          <button \r\n            className=\"ctr-btn nav-btn\" \r\n            onClick={handlePreviousEntry}\r\n            disabled={currentDateIndex <= 0}\r\n          >\r\n            ← Previous\r\n          </button>\r\n          <button \r\n            className=\"ctr-btn nav-btn\" \r\n            onClick={handleNextEntry}\r\n            disabled={currentDateIndex >= savedDates.length - 1}\r\n          >\r\n            Next →\r\n          </button>\r\n        </div>\r\n        <button \r\n          className=\"ctr-btn copy-btn\" \r\n          onClick={handleCopyToNextDay}\r\n          disabled={!days[1]}\r\n        >\r\n          Copy to Next 20 Days\r\n        </button>\r\n        <button \r\n          className=\"ctr-btn save-btn\" \r\n          onClick={handleSave}\r\n          disabled={!hasUnsavedChanges || !days[0] || !days[1]}\r\n        >\r\n          {hasUnsavedChanges ? 'Save Changes' : 'Saved'}\r\n        </button>\r\n      </div>\r\n\r\n      <div className=\"ctr-crew-info-form\">\r\n        <input\r\n          className=\"ctr-input\"\r\n          placeholder=\"Crew Name\"\r\n          value={crewInfo.crewName}\r\n          onChange={e => setCrewInfo({ ...crewInfo, crewName: e.target.value })}\r\n        />\r\n        <input\r\n          className=\"ctr-input\"\r\n          placeholder=\"Crew Number\"\r\n          value={crewInfo.crewNumber}\r\n          onChange={e => setCrewInfo({ ...crewInfo, crewNumber: e.target.value })}\r\n        />\r\n        <input\r\n          className=\"ctr-input\"\r\n          placeholder=\"Fire Name\"\r\n          value={crewInfo.fireName}\r\n          onChange={e => setCrewInfo({ ...crewInfo, fireName: e.target.value })}\r\n        />\r\n        <input\r\n          className=\"ctr-input\"\r\n          placeholder=\"Fire Number\"\r\n          value={crewInfo.fireNumber}\r\n          onChange={e => setCrewInfo({ ...crewInfo, fireNumber: e.target.value })}\r\n        />\r\n      </div>\r\n      <div className=\"ctr-actions\">\r\n        <input type=\"file\" accept=\".xlsx\" onChange={handleExcelUpload} />\r\n        <button className=\"ctr-btn\" onClick={handleExportExcel}>Export Excel</button>\r\n        <button className=\"ctr-btn\" onClick={handleExportPDF}>Export to PDF</button>\r\n        {showSaveDefault && (\r\n          <button className=\"ctr-btn\" onClick={handleSaveDefault} style={{ background: '#388e3c' }}>Save as Default</button>\r\n        )}\r\n        <button className=\"ctr-btn\" onClick={handleResetToDefault} style={{ background: '#888' }}>Reset to Default</button>\r\n        <button \r\n          className=\"ctr-btn\" \r\n          onClick={handleRemoveEntry}\r\n          disabled={!selectedDate}\r\n          style={{ background: '#d32f2f' }}\r\n        >\r\n          Remove Entry\r\n        </button>\r\n      </div>\r\n      <div style={{ overflowX: 'auto', maxWidth: '100%' }}>\r\n        <table className=\"ctr-table\">\r\n          <thead>\r\n            <tr>\r\n              <th className=\"ctr-th name\" rowSpan={2}>NAME</th>\r\n              <th className=\"ctr-th class\" rowSpan={2}>CLASS</th>\r\n              {days.map((date, i) => (\r\n                <th className=\"ctr-th date\" colSpan={2} key={i} style={{ textAlign: 'center' }}>\r\n                  DATE<br />\r\n                  <input\r\n                    className=\"ctr-input ctr-date\"\r\n                    type=\"date\"\r\n                    value={date}\r\n                    onChange={e => handleHeaderDateChange(e, i)}\r\n                    style={{ fontWeight: 'bold', fontSize: 14, textAlign: 'center', background: 'transparent', border: 'none', borderBottom: '1.5px solid #d32f2f' }}\r\n                  />\r\n                </th>\r\n              ))}\r\n              <th className=\"ctr-th\" rowSpan={2}></th>\r\n            </tr>\r\n            <tr>\r\n              {days.map((_, i) => (\r\n                <React.Fragment key={i}>\r\n                  <th className=\"ctr-th\">ON</th>\r\n                  <th className=\"ctr-th\">OFF</th>\r\n                </React.Fragment>\r\n              ))}\r\n            </tr>\r\n          </thead>\r\n          <tbody>\r\n            {Array.from({ length: 20 }).map((_, idx) => {\r\n              const row = data[idx] || {\r\n                name: '',\r\n                classification: '',\r\n                days: days.map(date => ({ date, on: '', off: '' }))\r\n              };\r\n              \r\n              return (\r\n                <tr key={idx} className=\"ctr-tr\">\r\n                  <td className=\"ctr-td\">\r\n                    {editingCell?.row === idx && editingCell?.field === 'name' ? (\r\n                      <input\r\n                        className=\"ctr-input\"\r\n                        value={row.name || ''}\r\n                        onChange={e => handleCellEdit(e, idx, 'name')}\r\n                        onBlur={handleCellBlur}\r\n                        autoFocus\r\n                      />\r\n                    ) : (\r\n                      <div \r\n                        className=\"ctr-cell-content\"\r\n                        onDoubleClick={() => handleCellDoubleClick(idx, 'name')}\r\n                        onTouchStart={() => handleCellDoubleTap(idx, 'name')}\r\n                      >\r\n                        {row.name || ''}\r\n                      </div>\r\n                    )}\r\n                  </td>\r\n                  <td className=\"ctr-td\">\r\n                    {editingCell?.row === idx && editingCell?.field === 'classification' ? (\r\n                      <input\r\n                        className=\"ctr-input\"\r\n                        value={row.classification}\r\n                        onChange={e => handleCellEdit(e, idx, 'classification')}\r\n                        onBlur={handleCellBlur}\r\n                        autoFocus\r\n                      />\r\n                    ) : (\r\n                      <div \r\n                        className=\"ctr-cell-content\"\r\n                        onDoubleClick={() => handleCellDoubleClick(idx, 'classification')}\r\n                        onTouchStart={() => handleCellDoubleTap(idx, 'classification')}\r\n                      >\r\n                        {row.classification}\r\n                      </div>\r\n                    )}\r\n                  </td>\r\n                  {row.days.map((day, dayIdx) => (\r\n                    <React.Fragment key={dayIdx}>\r\n                      <td className=\"ctr-td\">\r\n                        {editingCell?.row === idx && editingCell?.field === 'on' && editingCell?.dayIdx === dayIdx ? (\r\n                          <input\r\n                            className=\"ctr-input ctr-on\"\r\n                            value={day.on}\r\n                            onChange={e => handleCellEdit(e, idx, 'on', dayIdx)}\r\n                            onBlur={handleCellBlur}\r\n                            autoFocus\r\n                            placeholder=\"HHMM\"\r\n                            maxLength={4}\r\n                            inputMode=\"numeric\"\r\n                            pattern=\"[0-9]*\"\r\n                          />\r\n                        ) : (\r\n                          <div \r\n                            className=\"ctr-cell-content\"\r\n                            onDoubleClick={() => handleCellDoubleClick(idx, 'on', dayIdx)}\r\n                            onTouchStart={() => handleCellDoubleTap(idx, 'on', dayIdx)}\r\n                          >\r\n                            {day.on}\r\n                          </div>\r\n                        )}\r\n                      </td>\r\n                      <td className=\"ctr-td\">\r\n                        {editingCell?.row === idx && editingCell?.field === 'off' && editingCell?.dayIdx === dayIdx ? (\r\n                          <input\r\n                            className=\"ctr-input ctr-off\"\r\n                            value={day.off}\r\n                            onChange={e => handleCellEdit(e, idx, 'off', dayIdx)}\r\n                            onBlur={handleCellBlur}\r\n                            autoFocus\r\n                            placeholder=\"HHMM\"\r\n                            maxLength={4}\r\n                            inputMode=\"numeric\"\r\n                            pattern=\"[0-9]*\"\r\n                          />\r\n                        ) : (\r\n                          <div \r\n                            className=\"ctr-cell-content\"\r\n                            onDoubleClick={() => handleCellDoubleClick(idx, 'off', dayIdx)}\r\n                            onTouchStart={() => handleCellDoubleTap(idx, 'off', dayIdx)}\r\n                          >\r\n                            {day.off}\r\n                          </div>\r\n                        )}\r\n                      </td>\r\n                    </React.Fragment>\r\n                  ))}\r\n                  <td className=\"ctr-td\">\r\n                    {data[idx] && (\r\n                      <button \r\n                        className=\"ctr-btn\" \r\n                        style={{ background: '#d32f2f', padding: '2px 6px' }} \r\n                        onClick={() => handleDelete(idx)}\r\n                      >\r\n                        ×\r\n                      </button>\r\n                    )}\r\n                  </td>\r\n                </tr>\r\n              );\r\n            })}\r\n          </tbody>\r\n        </table>\r\n      </div>\r\n\r\n      {/* Total Hours Display */}\r\n      <div className=\"ctr-total-hours\">\r\n        <div className=\"ctr-total-label\">Total Hours Worked:</div>\r\n        <div className=\"ctr-total-value\">{totalHours.toFixed(2)}</div>\r\n      </div>\r\n\r\n      {showCalendar && (\r\n        <DateCalendar\r\n          savedDates={savedDates}\r\n          onDateSelect={handleDateSelect}\r\n          onClose={() => setShowCalendar(false)}\r\n        />\r\n      )}\r\n\r\n      {showCustomDatePicker !== null && (\r\n        <div className=\"custom-date-picker\">\r\n          <input\r\n            type=\"date\"\r\n            value={days[showCustomDatePicker]}\r\n            onChange={(e) => {\r\n              const newDate = e.target.value;\r\n              setDays(prev => prev.map((d, i) => (i === showCustomDatePicker ? newDate : d)));\r\n              setData(data => data.map(row => ({\r\n                ...row,\r\n                days: row.days.map((day, i) => i === showCustomDatePicker ? { ...day, date: newDate } : day)\r\n              })));\r\n              setHasUnsavedChanges(true);\r\n              setShowCustomDatePicker(null);\r\n            }}\r\n            onBlur={() => setShowCustomDatePicker(null)}\r\n            autoFocus\r\n          />\r\n        </div>\r\n      )}\r\n\r\n      {/* Add StoredPDFs component */}\r\n      <StoredPDFs />\r\n    </div>\r\n  );\r\n}\r\n\r\n// Add these styles to MainTable.css\r\nconst styles = `\r\n.ctr-date-selector {\r\n  display: flex;\r\n  align-items: center;\r\n  gap: 8px;\r\n  margin-bottom: 1rem;\r\n}\r\n\r\n.ctr-select {\r\n  padding: 0.5rem;\r\n  font-size: 1rem;\r\n  border: 1px solid #ccc;\r\n  border-radius: 4px;\r\n  min-width: 200px;\r\n  background-color: white;\r\n}\r\n\r\n.ctr-select:focus {\r\n  outline: none;\r\n  border-color: #d32f2f;\r\n}\r\n\r\n.calendar-btn {\r\n  padding: 0.5rem;\r\n  font-size: 1.2rem;\r\n  background: none;\r\n  border: 1px solid #ccc;\r\n  border-radius: 4px;\r\n  cursor: pointer;\r\n  transition: all 0.2s;\r\n}\r\n\r\n.calendar-btn:hover {\r\n  background-color: #f5f5f5;\r\n  border-color: #d32f2f;\r\n}\r\n\r\n.ctr-signature-section {\r\n  margin-top: 20px;\r\n  padding: 15px;\r\n  background-color: #f5f5f5;\r\n  border-radius: 4px;\r\n}\r\n\r\n.ctr-signature-display {\r\n  display: flex;\r\n  align-items: flex-start;\r\n  gap: 20px;\r\n}\r\n\r\n.ctr-signature-content {\r\n  flex: 1;\r\n}\r\n\r\n.ctr-signature-label {\r\n  color: #666;\r\n  font-weight: bold;\r\n  margin-bottom: 8px;\r\n}\r\n\r\n.ctr-signature-name {\r\n  color: #333;\r\n  margin-bottom: 12px;\r\n}\r\n\r\n.ctr-signature-image {\r\n  max-width: 300px;\r\n  border: 1px solid #ddd;\r\n  background: white;\r\n  padding: 10px;\r\n  border-radius: 4px;\r\n}\r\n\r\n.ctr-signature-image img {\r\n  width: 100%;\r\n  height: auto;\r\n}\r\n\r\n.signature-btn, .edit-signature-btn {\r\n  background: #1976d2;\r\n  white-space: nowrap;\r\n}\r\n\r\n.signature-btn:hover, .edit-signature-btn:hover {\r\n  background: #1565c0;\r\n}\r\n\r\n@media (max-width: 768px) {\r\n  .ctr-signature-section {\r\n    padding: 10px;\r\n  }\r\n\r\n  .ctr-signature-display {\r\n    flex-direction: column;\r\n    gap: 10px;\r\n  }\r\n\r\n  .ctr-signature-image {\r\n    max-width: 100%;\r\n  }\r\n}\r\n\r\n.custom-date-picker {\r\n  position: absolute;\r\n  top: 50%;\r\n  left: 50%;\r\n  transform: translate(-50%, -50%);\r\n  background: white;\r\n  padding: 20px;\r\n  border-radius: 8px;\r\n  box-shadow: 0 2px 10px rgba(0, 0, 0, 0.1);\r\n  z-index: 1000;\r\n}\r\n\r\n.custom-date-picker input {\r\n  font-size: 16px;\r\n  padding: 8px;\r\n  border: 1px solid #ccc;\r\n  border-radius: 4px;\r\n}\r\n\r\n.custom-date-picker input:focus {\r\n  outline: none;\r\n  border-color: #d32f2f;\r\n}\r\n`; ","import React from 'react';\r\nimport MainTable from './components/MainTable';\r\n\r\nexport default function App() {\r\n  return <MainTable />;\r\n} ","import React from 'react';\nimport ReactDOM from 'react-dom/client';\nimport App from './App';\nimport './styles.css';\n\n// Register service worker\nif ('serviceWorker' in navigator) {\n  window.addEventListener('load', async () => {\n    try {\n      // Check if there's an existing service worker\n      const existingRegistration = await navigator.serviceWorker.getRegistration();\n      \n      if (existingRegistration) {\n        // If there's an update, wait for it to be installed\n        existingRegistration.addEventListener('updatefound', () => {\n          const newWorker = existingRegistration.installing;\n          if (newWorker) {\n            newWorker.addEventListener('statechange', () => {\n              if (newWorker.state === 'installed') {\n                console.log('New service worker installed, will activate on next load');\n              }\n            });\n          }\n        });\n      } else {\n        // Only register new service worker if none exists\n        const registration = await navigator.serviceWorker.register('./sw.js', {\n          type: 'module',\n          scope: './'\n        });\n        console.log('SW registered: ', registration);\n      }\n    } catch (error) {\n      console.error('SW registration failed: ', error);\n    }\n  });\n} else {\n  console.warn('Service workers are not supported in this browser');\n}\n\nReactDOM.createRoot(document.getElementById('root')!).render(\n  <React.StrictMode>\n    <App />\n  </React.StrictMode>\n); "],"names":["f","require$$0","k","l","m","n","p","q","c","a","g","b","d","e","h","reactJsxRuntime_production_min","jsxRuntimeModule","client","defaultData","mapToPDFFields","data","crewInfo","signature","fields","_a","_b","row","idx","rowNum","generateExportFilename","info","date","crewNumber","fireName","fireNumber","type","formattedDate","safeCrewNumber","safeFireName","safeFireNumber","filename","instanceOfAny","object","constructors","idbProxyableTypes","cursorAdvanceMethods","getIdbProxyableTypes","getCursorAdvanceMethods","cursorRequestMap","transactionDoneMap","transactionStoreNamesMap","transformCache","reverseTransformCache","promisifyRequest","request","promise","resolve","reject","unlisten","success","error","wrap","value","cacheDonePromiseForTransaction","tx","done","complete","idbProxyTraps","target","prop","receiver","replaceTraps","callback","wrapFunction","func","storeNames","args","unwrap","transformCachableValue","newValue","openDB","name","version","blocked","upgrade","blocking","terminated","openPromise","event","db","readMethods","writeMethods","cachedMethods","getMethod","targetFuncName","useIndex","isWrite","method","storeName","oldTraps","DB_NAME","STORE_NAME","DB_VERSION","initDB","storePDF","pdfBlob","metadata","id","getPDF","pdf","listPDFs","pdfs","deletePDF","fillCTRPDF","pdfUrl","urlWithCacheBust","response","pdfBytes","pdfDoc","PDFDocument","form","field","filledPdfBytes","blob","_d","_c","url","CTR_TEMPLATE_MAPPING","fillExcelTemplate","days","templateUrl","mapping","templateData","workbook","XLSX.read","worksheet","startRow","totalHours","calculateTotalHours","total","day","on","parseMilitaryTime","off","time","CTRDataService","date1","date2","dateRange","ranges","ctrDataService","Notification","props","message","onClose","duration","React","timer","jsxs","jsx","EXCEL_CELL_MAPPING","getMergedCellValue","cellAddress","merges","XLSXUtils","XLSX.utils","merge","topLeft","mapExcelToData","crewMembers","nameCell","crewMember","member","onTime","convertToMinutes","offTime","hours","minutes","match","DateCalendar","savedDates","onDateSelect","currentDate","setCurrentDate","useState","selectedDate","setSelectedDate","calendarDays","setCalendarDays","useEffect","year","month","firstDay","lastDay","daysFromPrevMonth","daysFromNextMonth","i","handlePrevMonth","handleNextMonth","handleDateClick","dateStr","matchingDateRange","range","start","end","isDateSaved","isCurrentMonth","index","StoredPDFs","setPdfs","loading","setLoading","setError","selectedPDF","setSelectedPDF","setPdfUrl","sortField","setSortField","sortDirection","setSortDirection","isDrawing","setIsDrawing","drawingMode","setDrawingMode","canvasSize","setCanvasSize","canvasRef","useRef","contextRef","lastPoint","pdfViewerRef","canvas","context","updateCanvasSize","width","height","resizeObserver","startDrawing","rect","point","getEventPoint","draw","stopDrawing","touch","clearDrawing","saveDrawing","drawingBlob","pdfArrayBuffer","drawingImage","page","modifiedPdfBytes","modifiedPdfBlob","refreshPDFs","storedPDFs","updatedPDF","handleSort","sortedPDFs","comparison","handleOpen","handleClose","handleDownload","handleDelete","Fragment","STORAGE_KEY","saveData","loadData","raw","MainTable","setData","loadedData","dayCount","setDayCount","setDays","loadedDates","showSaveDefault","setShowSaveDefault","setCrewInfo","editingCell","setEditingCell","lastTap","setLastTap","setSavedDates","hasUnsavedChanges","setHasUnsavedChanges","notification","setNotification","lastSavedState","setLastSavedState","currentDateIndex","setCurrentDateIndex","lastSavedTotalHours","setLastSavedTotalHours","lastSavedCrewInfo","setLastSavedCrewInfo","showCalendar","setShowCalendar","showCustomDatePicker","setShowCustomDatePicker","loadSavedDates","hasCrewInfo","hasDates","hoursChanged","crewInfoChanged","dateRanges","showNotification","hideNotification","prev","handleSave","findCurrentDateIndex","handlePreviousEntry","currentIndex","prevDateRange","handleDateSelect","handleNextEntry","nextDateRange","record","loadedTotalHours","handleCellDoubleTap","rowIdx","dayIdx","now","handleCellDoubleClick","validateMilitaryTime","digits","handleCellEdit","newData","fftIndex","fftTimes","handleCellBlur","_","handleHeaderDateChange","newDate","handleResetToDefault","handleSaveDefault","handleExportExcel","wb","XLSX.writeFile","errorMessage","handleExportPDF","handleExcelUpload","file","reader","evt","sheetName","importedCrewInfo","dates","handleCopyToNextDay","startDate","endDate","daysDiff","newStartDate","newEndDate","newStartDateStr","newEndDateStr","handleRemoveEntry","App","existingRegistration","newWorker","registration","ReactDOM"],"mappings":"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","x_google_ignoreList":[0,1,2,6,7]}